<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns= "http://www.w3c.org/1999/xhtml">

<head>
<title>D-LINK</title>
<meta http-equiv="X-UA-Compatible" content="IE=9">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="Content-Type" content="text/css">
<link rel=stylesheet type="text/css" href="/css/jquery.selectbox.css" />
<script type="text/javascript" charset="utf-8" src="/js/initialJQ.js"></script>
<script type="text/javascript" charset="utf-8" src="/js/initialJS.js"></script>
<script type="text/javascript" charset="utf-8" src="/js/initialCSS.js"></script>
<script type="text/javascript" charset="utf-8" src="/js/initialValidate1.js"></script>
<script type="text/javascript" charset="utf-8" src="/js/SOAP/SOAPInternet.js"></script>
<script type="text/javascript" charset="utf-8" src="/js/SOAP/SOAPWLanRadio.js"></script>
<script type="text/javascript">
	var HNAP = new HNAP_XML();
	var Total_EthernetClients = 0;
	var tmp_MACAddress;
	var lan_IPAddr;
	var wan_IPv6type;
	var PppoeNewSession;
	var _ReciprocalNumber = 25;
	var _ReciprocalRebootNumber = 80;
	// Create Array to storage
	var array2Dv;

	var xml_GetDeviceFeature = HNAP.GetXML("GetDeviceFeatureAlpha");
	var featureCN = xml_GetDeviceFeature.Get("GetDeviceFeatureAlphaResponse/FeatureCN");
	/* Support WAN_VLAN */ 
	var feature_vlan = xml_GetDeviceFeature.Get("GetDeviceFeatureAlphaResponse/FeatureVLAN");
	var vlanSettings;
	/* Support WAN_VLAN_SSID - Get Settings - Start */
	var feature_vlanssid = xml_GetDeviceFeature.Get("GetDeviceFeatureAlphaResponse/FeatureVLANSSID");
	/* Support disable_NAT */
	var feature_nat = xml_GetDeviceFeature.Get("GetDeviceFeatureAlphaResponse/FeatureNAT");
	var natSettings;

	function Array2DVar(x, y)
	{
		this.length = x;
		this.x = x;
		this.y = y;
		for(var i = 0; i < this.length; i++)	{	this[i] = new Array(y);	}
	}

	function Load_HTML()	{	$("#header").load("header.html");	}
	function Initial()
	{
		initialMenu();
		initialDetectRouterConnection();
	}
	function String_UC(str)	{	str = str.toUpperCase();	return str;	}
	function GetXML()	{	HNAP.GetXMLAsync("GetMultipleHNAPs", null, "GetXML", function(xml)	{	GetResult_1st(xml)	});	}
	function GetResult_1st(result_xml)
	{
		if (result_xml != null)
		{
			result_xml.Set("GetMultipleHNAPs/GetClientInfo");
			result_xml.Set("GetMultipleHNAPs/GetWanSettings");
			result_xml.Set("GetMultipleHNAPs/GetIPv6Status");
			result_xml.Set("GetMultipleHNAPs/GetClientInfo");
			result_xml.Set("GetMultipleHNAPs/GetNetworkSettings");
			result_xml.Set("GetMultipleHNAPs/GetIPv6PppoeSettings");
			HNAP.SetXMLAsync("GetMultipleHNAPs", result_xml, function(xml)	{	GetResult_2nd(xml);	});
		}
		else	{	if (DebugMode == 1)	{	alert("[!!GetXML Error!!] Function: GetResult_1st");	}	}
	}
	function GetResult_2nd(result_xml)
	{
		var GetResult_2nd = result_xml.Get("GetMultipleHNAPsResponse/GetMultipleHNAPsResult");
		if (GetResult_2nd == "OK")
		{
			/* Support WAN_VLAN - PPPoE with VLAN(UniPPPoE) */
			if(feature_vlan == "true") { $("#connection_Type").append('<option value="7">Unifi-PPPoE</option>'); }

			var count = 0;
			var Add_Select1 = document.getElementById("clone_ComputerIp");
			var Add_Select2 = document.getElementById("clone_ComputerIpByStaticIP");
			var Add_Select3 = document.getElementById("clone_ComputerIpByPPPoE");
			Total_EthernetClients = result_xml.Get("GetMultipleHNAPsResponse/GetClientInfoResponse/ClientInfoLists/ClientInfo#");
			array2Dv = new Array2DVar(Total_EthernetClients, 1);
			for (var i = 1; i <= Total_EthernetClients; i ++)
			{
				array2Dv[count][0] = String_UC(result_xml.Get("GetMultipleHNAPsResponse/GetClientInfoResponse/ClientInfoLists/ClientInfo:" + i + "/MacAddress"));
				Add_Select1.options.add(new Option(array2Dv[count][0], i));
				Add_Select2.options.add(new Option(array2Dv[count][0], i));
				Add_Select3.options.add(new Option(array2Dv[count][0], i));
				count ++;
			}
			var wan_type = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/Type");
			var wan_MACAddress = String_UC(result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/MacAddress"));
			document.getElementById("macAddress_StaticIP").value = wan_MACAddress;
			document.getElementById("macAddress_DynamicIP").value = wan_MACAddress;
			document.getElementById("macAddress_PPPoE").value = wan_MACAddress;
			tmp_MACAddress = wan_MACAddress;
			switch (wan_type)
			{
				case "Static":
					document.getElementById("connection_Type").options[0].selected = true;
					// IPAddress
					var static_Ipaddress = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/IPAddress");
					document.getElementById("iPAddress_StaticIP").value = static_Ipaddress;
					// Subnetmask
					var static_Subnetmask = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/SubnetMask");
					document.getElementById("subnetMask_StaticIP").value = static_Subnetmask;
					// Default Gateway
					var static_Defaultgateway = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/Gateway");
					document.getElementById("defaultGateway_StaticIP").value = static_Defaultgateway;
					// Primary DNS Address
					var static_Pridns = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/ConfigDNS/Primary");
					document.getElementById("primaryDNSAddress_StaticIP").value = static_Pridns;
					// Secondary DNS Address
					var static_Secdns = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/ConfigDNS/Secondary");
					document.getElementById("secondaryDNSAddress_StaticIP").value = static_Secdns;
					// MTU
					var static_MTU = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/MTU");
					document.getElementById("mtu_StaticIP_Input").value = static_MTU;
					if (static_MTU == "1500")	{	document.getElementById("mtu_StaticIP").options[0].selected = true;	}
					else
					{
						document.getElementById("mtu_StaticIP").options[1].selected = true;
						document.getElementById("mtu_StaticIP_Input").style.display = "inline";
					}
					try	{	onload = internetV4_showGeneral(0);	}
					catch (err) {}
					break;
				case "DHCP":
					// Change Connection Type
					document.getElementById("connection_Type").options[1].selected = true;
					// Host Name
					var Host_Name = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/HostName");
					document.getElementById("hostName_DynamicIP").value = Host_Name;
					// Primary DNS Address
					var DHCP_Pridns = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/ConfigDNS/Primary");
					document.getElementById("primaryDNSAddress_DynamicIP").value = DHCP_Pridns;
					// Secondary DNS Address
					var DHCP_Secdns = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/ConfigDNS/Secondary");
					document.getElementById("secondaryDNSAddress_DynamicIP").value = DHCP_Secdns;
					// MTU
					var DHCP_MTU = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/MTU");
					document.getElementById("mtu_DynamicIP_Input").value = DHCP_MTU;
					if (DHCP_MTU == "1500")	{	document.getElementById("mtu_DynamicIP").options[0].selected = true;	}
					else
					{
						document.getElementById("mtu_DynamicIP").options[1].selected = true;
						document.getElementById("mtu_DynamicIP_Input").style.display = "inline";
					}
					try	{	onload = internetV4_showGeneral(1);	}
					catch (err) {}
					break;
				case "DHCPPPPoE":
					var unipppoe = 0;
					if(feature_vlan == "true")
					{
						var xml_GetVlanSettings = HNAP.GetXML("GetVlanSettings");
						var vlan_active = xml_GetVlanSettings.Get("GetVlanSettingsResponse/active");
						if(vlan_active=="1") unipppoe = 1;
					}
					// Change Connection Type
					if(unipppoe==0) document.getElementById("connection_Type").options[2].selected = true;
					else            document.getElementById("connection_Type").options[6].selected = true;
					document.getElementById("addressMode_PPPoE").options[0].selected = true;
					document.getElementById("ipAddress_PPPoE").disabled = true;
					// Username
					var DHCPPPPoE_Username = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/Username");
					document.getElementById("userName_PPPoE").value = DHCPPPPoE_Username;
					// Password
					var DHCPPPPoE_Password = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/Password");
					document.getElementById("password_PPPoE").value = DHCPPPPoE_Password;
					// IP Address
					var DHCPPPPoE_Ipaddress = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/IPAddress");
					document.getElementById("ipAddress_PPPoE").value = DHCPPPPoE_Ipaddress;
					// Service Name
					var DHCPPPPoE_Servicename = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/ServiceName");
					document.getElementById("serviceName_PPPoE").value = DHCPPPPoE_Servicename;
					// Primary DNS Address
					var DHCPPPPoE_Pridns = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/ConfigDNS/Primary");
					document.getElementById("primaryDNSAddress_PPPoE").value = DHCPPPPoE_Pridns;
					// Secondary DNS Address
					var DHCPPPPoE_Secdns = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/ConfigDNS/Secondary");
					document.getElementById("secondaryDNSAddress_PPPoE").value = DHCPPPPoE_Secdns;
					// MTU
					var PPPoE_MTU = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/MTU");
					document.getElementById("mtu_PPPoE_Input").value = PPPoE_MTU;
					if (PPPoE_MTU == "1492")	{	document.getElementById("mtu_PPPoE").options[0].selected = true;	}
					else
					{
						document.getElementById("mtu_PPPoE").options[1].selected = true;
						document.getElementById("mtu_PPPoE_Input").style.display = "inline";
					}
					// Reconnect Mode
					var PPPoE_Reconnect = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/AutoReconnect");
					// Maximum Idle Time
					var maximumidletime = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/MaxIdleTime");
					var PPPoE_Maximumidletime = maximumidletime/60;
					switch (PPPoE_Reconnect)
					{
						case "true":
							// Always On
							document.getElementById("reconnectMode_PPPoE").options[0].selected = true;
							document.getElementById("maxIdleTime_PPPoE_tr").style.display = "none";
							document.getElementById("maximumIdleTime_PPPoE").value = 0;
							document.getElementById("maximumIdleTime_PPPoE").disabled  = true;
							break;
						case "false":
							if (PPPoE_Maximumidletime == 0)
							{
								// Manual
								document.getElementById("reconnectMode_PPPoE").options[2].selected = true;
								document.getElementById("maxIdleTime_PPPoE_tr").style.display = "none";
								document.getElementById("maximumIdleTime_PPPoE").value = 0;
								document.getElementById("maximumIdleTime_PPPoE").disabled  = true;
							}
							else
							{
								// On Demand
								document.getElementById("reconnectMode_PPPoE").options[1].selected = true;
								document.getElementById("maximumIdleTime_PPPoE").value = PPPoE_Maximumidletime;
								document.getElementById("maximumIdleTime_PPPoE").disabled  = false;
							}
							break;
					}
					try	{
						if(unipppoe==0) onload = internetV4_showGeneral(2);
						else            onload = internetV4_showGeneral(6);
					}
					catch (err) {}
					break;
				case "StaticPPPoE":
					var unipppoe = 0;
					if(feature_vlan == "true")
					{
						var xml_GetVlanSettings = HNAP.GetXML("GetVlanSettings");
						var vlan_active = xml_GetVlanSettings.Get("GetVlanSettingsResponse/active");
						if(vlan_active=="1") unipppoe = 1;
					}
					// Change Connection Type
					if(unipppoe==0) document.getElementById("connection_Type").options[2].selected = true;
					else            document.getElementById("connection_Type").options[6].selected = true;
					document.getElementById("addressMode_PPPoE").options[1].selected = true;
					document.getElementById("ipAddress_PPPoE").disabled = false;
					// Username
					var DHCPPPPoE_Username = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/Username");
					document.getElementById("userName_PPPoE").value = DHCPPPPoE_Username;
					// Password
					var DHCPPPPoE_Password = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/Password");
					document.getElementById("password_PPPoE").value = DHCPPPPoE_Password;
					// IP Address
					var DHCPPPPoE_Ipaddress = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/IPAddress");
					document.getElementById("ipAddress_PPPoE").value = DHCPPPPoE_Ipaddress;
					document.getElementById("ipAddress_tr").style.display = "table-row";
					// Service Name
					var DHCPPPPoE_Servicename = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/ServiceName");
					document.getElementById("serviceName_PPPoE").value = DHCPPPPoE_Servicename;
					// Primary DNS Address
					var DHCPPPPoE_Pridns = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/ConfigDNS/Primary");
					document.getElementById("primaryDNSAddress_PPPoE").value = DHCPPPPoE_Pridns;
					// Secondary DNS Address
					var DHCPPPPoE_Secdns = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/ConfigDNS/Secondary");
					document.getElementById("secondaryDNSAddress_PPPoE").value = DHCPPPPoE_Secdns;
					// MTU
					var PPPoE_MTU = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/MTU");
					document.getElementById("mtu_PPPoE_Input").value = PPPoE_MTU;
					if (PPPoE_MTU == "1492")	{	document.getElementById("mtu_PPPoE").options[0].selected = true;	}
					else
					{
						document.getElementById("mtu_PPPoE").options[1].selected = true;
						document.getElementById("mtu_PPPoE_Input").style.display = "inline";
					}
					// Reconnect Mode
					var PPPoE_Reconnect = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/AutoReconnect");
					// Maximum Idle Time
					var maximumidletime = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/MaxIdleTime");
					var PPPoE_Maximumidletime = maximumidletime/60;
					switch (PPPoE_Reconnect)
					{
						case "true":
							// Always On
							document.getElementById("reconnectMode_PPPoE").options[0].selected = true;
							document.getElementById("maximumIdleTime_PPPoE").value = 0;
							document.getElementById("maximumIdleTime_PPPoE").disabled  = true;
							break;
						case "false":
							if (PPPoE_Maximumidletime == 0)
							{
								// Manual
								document.getElementById("reconnectMode_PPPoE").options[2].selected = true;
								document.getElementById("maximumIdleTime_PPPoE").value = 0;
								document.getElementById("maximumIdleTime_PPPoE").disabled  = true;
							}
							else
							{
								// On Demand
								document.getElementById("reconnectMode_PPPoE").options[1].selected = true;
								document.getElementById("maximumIdleTime_PPPoE").value = PPPoE_Maximumidletime;
								document.getElementById("maximumIdleTime_PPPoE").disabled  = false;
							}
							break;
					}
					try	{
						if(unipppoe==0) onload = internetV4_showGeneral(2);
						else            onload = internetV4_showGeneral(6);
					}
					catch (err) {}
					break;
				case "StaticPPTP":
					document.getElementById("connection_Type").options[3].selected = true;
					document.getElementById("addressMode_PPTP").options[1].selected = true;
					// PPTP Server IP Address
					var PPTP_ServerIPAddress = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/ServiceName");
					document.getElementById("serverIPAddress_PPTP").value = PPTP_ServerIPAddress;
					// User Name
					var PPTP_Username = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/Username");
					document.getElementById("userName_PPTP").value = PPTP_Username;
					// Password
					var PPTP_Password = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/Password");
					document.getElementById("password_PPTP").value = PPTP_Password;
					// IP Address
					var PPTP_Ipaddress = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/IPAddress");
					document.getElementById("ipAddress_PPTP").value = PPTP_Ipaddress;
					document.getElementById("ipAddress_PPTP_tr").style.display = "table-row";
					document.getElementById("subnetMask_PPTP_tr").style.display = "table-row";
					document.getElementById("gatewayIP_PPTP_tr").style.display = "table-row";
					// Subnetmask
					var PPTP_Subnetmask = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/SubnetMask");
					document.getElementById("subnetMask_PPTP").value = PPTP_Subnetmask;
					// Gateway IP Address
					var PPTP_GatewayIPAddress = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/Gateway");
					document.getElementById("gatewayIP_PPTP").value = PPTP_GatewayIPAddress;		
					// Primary DNS Address
					var PPTP_Pridns = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/ConfigDNS/Primary");
					document.getElementById("primaryDNSAddress_PPTP").value = PPTP_Pridns;
					// Secondary DNS Address
					var PPTP_Secdns = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/ConfigDNS/Secondary");
					document.getElementById("secondaryDNSAddress_PPTP").value = PPTP_Secdns;
					// MTU
					var PPTP_MTU = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/MTU");
					document.getElementById("mtu_PPTP_Input").value = PPTP_MTU;
					if (PPTP_MTU == "1400")	{	document.getElementById("mtu_PPTP").options[0].selected = true;	}
					else
					{
						document.getElementById("mtu_PPTP").options[1].selected = true;
						document.getElementById("mtu_PPTP_Input").style.display = "inline";
					}
					
					// Maximum Idle Time
					var maximumidletime = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/MaxIdleTime");
					var PPTP_Maximumidletime = maximumidletime/60;

					document.getElementById("maximumIdleTime_PPTP").value = PPTP_Maximumidletime;
					// Reconnect Mode
					var PPTP_Reconnect = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/AutoReconnect");
					switch (PPTP_Reconnect)
					{
						case "true":
							// Always On
							document.getElementById("reconnectMode_PPTP").options[0].selected = true;
							document.getElementById("maxIdleTime_PPTP_tr").style.display = "none";
							document.getElementById("maximumIdleTime_PPTP").value = 0;
							document.getElementById("maximumIdleTime_PPTP").disabled  = true;
							break;
						case "false":
							if (PPTP_Maximumidletime == 0)
							{
								// Manual
								document.getElementById("reconnectMode_PPTP").options[2].selected = true;
								document.getElementById("maxIdleTime_PPTP_tr").style.display = "none";
								document.getElementById("maximumIdleTime_PPTP").value = 0;
								document.getElementById("maximumIdleTime_PPTP").disabled  = true;
							}
							else
							{
								// On Demand
								document.getElementById("reconnectMode_PPTP").options[1].selected = true;
								document.getElementById("maximumIdleTime_PPTP").value = PPTP_Maximumidletime;
								document.getElementById("maximumIdleTime_PPTP").disabled  = false;
							}
							break;
					}
					try	{	onload = internetV4_showGeneral(3);	}
					catch (err) {}
					break;
				case "DynamicPPTP":
					document.getElementById("connection_Type").options[3].selected = true;
					document.getElementById("addressMode_PPTP").options[0].selected = true;
					// PPTP Server IP Address
					var PPTP_ServerIPAddress = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/ServiceName");
					document.getElementById("serverIPAddress_PPTP").value = PPTP_ServerIPAddress;
					// User Name
					var PPTP_Username = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/Username");
					document.getElementById("userName_PPTP").value = PPTP_Username;
					// Password
					var PPTP_Password = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/Password");
					document.getElementById("password_PPTP").value = PPTP_Password;
					// IP Address
					var PPTP_Ipaddress = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/IPAddress");
					document.getElementById("ipAddress_PPTP").value = PPTP_Ipaddress;
					// Subnetmask
					var PPTP_Subnetmask = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/SubnetMask");
					document.getElementById("subnetMask_PPTP").value = PPTP_Subnetmask;
					// Gateway IP Address
					var PPTP_GatewayIPAddress = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/Gateway");
					document.getElementById("gatewayIP_PPTP").value = PPTP_GatewayIPAddress;
					// Primary DNS Address
					var PPTP_Pridns = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/ConfigDNS/Primary");
					document.getElementById("primaryDNSAddress_PPTP").value = PPTP_Pridns;
					// Secondary DNS Address
					var PPTP_Secdns = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/ConfigDNS/Secondary");
					document.getElementById("secondaryDNSAddress_PPTP").value = PPTP_Secdns;
					// MTU
					var PPTP_MTU = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/MTU");
					document.getElementById("mtu_PPTP_Input").value = PPTP_MTU;
					if (PPTP_MTU == "1400")	{	document.getElementById("mtu_PPTP").options[0].selected = true;	}
					else
					{
						document.getElementById("mtu_PPTP").options[1].selected = true;
						document.getElementById("mtu_PPTP_Input").style.display = "inline";
					}
					// Maximum Idle Time
					var maximumidletime = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/MaxIdleTime");
					var PPTP_Maximumidletime = maximumidletime/60;
					
					document.getElementById("maximumIdleTime_PPTP").value = PPTP_Maximumidletime;
					// Reconnect Mode
					var PPTP_Reconnect = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/AutoReconnect");
					switch (PPTP_Reconnect)
					{
						case "true":
							// Always On
							document.getElementById("reconnectMode_PPTP").options[0].selected = true;
							document.getElementById("maxIdleTime_PPTP_tr").style.display = "none";
							document.getElementById("maximumIdleTime_PPTP").value = 0;
							document.getElementById("maximumIdleTime_PPTP").disabled  = true;
							break;
						case "false":
							if (PPTP_Maximumidletime == 0)
							{
								// Manual
								document.getElementById("reconnectMode_PPTP").options[2].selected = true;
								document.getElementById("maxIdleTime_PPTP_tr").style.display = "none";
								document.getElementById("maximumIdleTime_PPTP").value = 0;
								document.getElementById("maximumIdleTime_PPTP").disabled  = true;
							}
							else
							{
								// On Demand
								document.getElementById("reconnectMode_PPTP").options[1].selected = true;
								document.getElementById("maximumIdleTime_PPTP").value = PPTP_Maximumidletime;
								document.getElementById("maximumIdleTime_PPTP").disabled  = false;
							}
							break;
					}
					try	{	onload = internetV4_showGeneral(3);	}
					catch (err) {}
					break;
				case "StaticL2TP":
					document.getElementById("connection_Type").options[4].selected = true;
					document.getElementById("addressMode_L2TP").options[1].selected = true;
					document.getElementById("ipAddress_L2TP").disabled = false;
					document.getElementById("subnetMask_L2TP").disabled = false;
					document.getElementById("gatewayIP_L2TP").disabled = false;
					// L2TP Server IP Address
					var L2TP_ServerIPAddress = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/ServiceName");
					document.getElementById("serverIPAddress_L2TP").value = L2TP_ServerIPAddress;
					// User Name
					var L2TP_Username = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/Username");
					document.getElementById("userName_L2TP").value = L2TP_Username;
					// Password
					var L2TP_Password = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/Password");
					document.getElementById("password_L2TP").value = L2TP_Password;
					// IP Address
					var L2TP_Ipaddress = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/IPAddress");
					document.getElementById("ipAddress_L2TP").value = L2TP_Ipaddress;
					document.getElementById("ipAddress_L2TP_tr").style.display = "table-row";
					document.getElementById("subnetMask_L2TP_tr").style.display = "table-row";
					document.getElementById("gatewayIP_L2TP_tr").style.display = "table-row";
					// Subnetmask
					var L2TP_Subnetmask = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/SubnetMask");
					document.getElementById("subnetMask_L2TP").value = L2TP_Subnetmask;
					// Gateway IP Address
					var L2TP_GatewayIPAddress = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/Gateway");
					document.getElementById("gatewayIP_L2TP").value = L2TP_GatewayIPAddress;
					// Primary DNS Address
					var L2TP_Pridns = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/ConfigDNS/Primary");
					document.getElementById("primaryDNSAddress_L2TP").value = L2TP_Pridns;
					// Secondary DNS Address
					var L2TP_Secdns = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/ConfigDNS/Secondary");
					document.getElementById("secondaryDNSAddress_L2TP").value = L2TP_Secdns;
					// MTU
					var L2TP_MTU = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/MTU");
					document.getElementById("mtu_L2TP_Input").value = L2TP_MTU;
					if (L2TP_MTU == "1400")	{	document.getElementById("mtu_L2TP").options[0].selected = true;	}
					else
					{
						document.getElementById("mtu_L2TP").options[1].selected = true;
						document.getElementById("mtu_L2TP_Input").style.display = "inline";
					}
					// Maximum Idle Time
					var maximumidletime = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/MaxIdleTime");
					var L2TP_Maximumidletime = maximumidletime/60;
					
					document.getElementById("maximumIdleTime_L2TP").value = L2TP_Maximumidletime;
					// Reconnect Mode
					var L2TP_Reconnect = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/AutoReconnect");
					switch (L2TP_Reconnect)
					{
						case "true":
							// Always On
							document.getElementById("reconnectMode_L2TP").options[0].selected = true;
							document.getElementById("maximumIdleTime_L2TP_tr").style.display = "none";
							document.getElementById("maximumIdleTime_L2TP").value = 0;
							document.getElementById("maximumIdleTime_L2TP").disabled  = true;
							break;
						case "false":
							if (L2TP_Maximumidletime == 0)
							{
								// Manual
								document.getElementById("reconnectMode_L2TP").options[2].selected = true;
								document.getElementById("maximumIdleTime_L2TP_tr").style.display = "none";
								document.getElementById("maximumIdleTime_L2TP").value = 0;
								document.getElementById("maximumIdleTime_L2TP").disabled  = true;
							}
							else
							{
								// On Demand
								document.getElementById("reconnectMode_L2TP").options[1].selected = true;
								document.getElementById("maximumIdleTime_L2TP").value = L2TP_Maximumidletime;
								document.getElementById("maximumIdleTime_L2TP").disabled  = false;
							}
							break;
					}
					try	{	onload = internetV4_showGeneral(4);	}
					catch (err) {}
					break;
				case "DynamicL2TP":
					document.getElementById("connection_Type").options[4].selected = true;
					document.getElementById("addressMode_L2TP").options[0].selected = true;
					document.getElementById("ipAddress_L2TP").disabled = false;
					document.getElementById("subnetMask_L2TP").disabled = false;
					document.getElementById("gatewayIP_L2TP").disabled = false;
					// L2TP Server IP Address
					var L2TP_ServerIPAddress = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/ServiceName");
					document.getElementById("serverIPAddress_L2TP").value = L2TP_ServerIPAddress;
					// User Name
					var L2TP_Username = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/Username");
					document.getElementById("userName_L2TP").value = L2TP_Username;
					// Password
					var L2TP_Password = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/Password");
					document.getElementById("password_L2TP").value = L2TP_Password;
					// IP Address
					var L2TP_Ipaddress = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/IPAddress");
					document.getElementById("ipAddress_L2TP").value = L2TP_Ipaddress;
					// Subnetmask
					var L2TP_Subnetmask = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/SubnetMask");
					document.getElementById("subnetMask_L2TP").value = L2TP_Subnetmask;
					// Gateway IP Address
					var L2TP_GatewayIPAddress = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/Gateway");
					document.getElementById("gatewayIP_L2TP").value = L2TP_GatewayIPAddress;
					// Primary DNS Address
					var L2TP_Pridns = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/ConfigDNS/Primary");
					document.getElementById("primaryDNSAddress_L2TP").value = L2TP_Pridns;
					// Secondary DNS Address
					var L2TP_Secdns = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/ConfigDNS/Secondary");
					document.getElementById("secondaryDNSAddress_L2TP").value = L2TP_Secdns;
					// MTU
					var L2TP_MTU = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/MTU");
					document.getElementById("mtu_L2TP_Input").value = L2TP_MTU;
					if (L2TP_MTU == "1400")	{	document.getElementById("mtu_L2TP").options[0].selected = true;	}
					else
					{
						document.getElementById("mtu_L2TP").options[1].selected = true;
						document.getElementById("mtu_L2TP_Input").style.display = "inline";
					}
					// Maximum Idle Time
					var maximumidletime = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/MaxIdleTime");
					var L2TP_Maximumidletime = maximumidletime/60;
					
					document.getElementById("maximumIdleTime_L2TP").value = L2TP_Maximumidletime;
					// Reconnect Mode
					var L2TP_Reconnect = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/AutoReconnect");
					switch (L2TP_Reconnect)
					{
						case "true":
							// Always On
							document.getElementById("reconnectMode_L2TP").options[0].selected = true;
							document.getElementById("maximumIdleTime_L2TP_tr").style.display = "none";
							document.getElementById("maximumIdleTime_L2TP").value = 0;
							document.getElementById("maximumIdleTime_L2TP").disabled  = true;
							break;
						case "false":
							if (L2TP_Maximumidletime == 0)
							{
								// Manual
								document.getElementById("reconnectMode_L2TP").options[2].selected = true;
								document.getElementById("maximumIdleTime_L2TP_tr").style.display = "none";
								document.getElementById("maximumIdleTime_L2TP").value = 0;
								document.getElementById("maximumIdleTime_L2TP").disabled  = true;
							}
							else
							{
								// On Demand
								document.getElementById("reconnectMode_L2TP").options[1].selected = true;
								document.getElementById("maximumIdleTime_L2TP").value = L2TP_Maximumidletime;
								document.getElementById("maximumIdleTime_L2TP").disabled  = false;
							}
							break;
					}
					try	{	onload = internetV4_showGeneral(4);	}
					catch (err) {}
					break;
				case "DsLite":
					document.getElementById("connection_Type").options[5].selected = true;
					// DSLite Configuration
					var DSLite__Configuration = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/DsLite_Configuration");
					//alert(DSLite__Configuration);
					switch (DSLite__Configuration)
					{
						case "Dhcpv6Option":	document.getElementById("configuration_DSLite").options[0].selected = true;	break;
						case "Manual":			document.getElementById("configuration_DSLite").options[1].selected = true;	break;
					}
					// AFTR IPv6 Address
					var DSLite__AFTR_IPv6Address = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/DsLite_AFTR_IPv6Address");
					document.getElementById("afterIPv6Address_DSLite").value = DSLite__AFTR_IPv6Address;
					// B4 IPv4 Address
					var DSLite__B4IPv4Address = result_xml.Get("GetMultipleHNAPsResponse/GetWanSettingsResponse/DsLite_B4IPv4Address");
					var split_DSLite__B4IPv4Address = DSLite__B4IPv4Address.split(".");
					var last_Elementalert = split_DSLite__B4IPv4Address[split_DSLite__B4IPv4Address.length - 1];
					document.getElementById("b4IPv4Address_DSLite").value = last_Elementalert;
					// WAN IPv6 Address
					var DSLite__IPv6_Address = result_xml.Get("GetMultipleHNAPsResponse/GetIPv6StatusResponse/IPv6_Address");
					if (DSLite__IPv6_Address != "")	{	document.getElementById("wanIPv6Address_DSLite").innerHTML = DSLite__IPv6_Address;	}
					else					{	document.getElementById("wanIPv6Address_DSLite").innerHTML = I18N("j", "Not Available");	}
					// IPv6 WAN Default Gateway
					var DSLite__DefaultGateway = result_xml.Get("GetMultipleHNAPsResponse/GetIPv6StatusResponse/IPv6_DefaultGateway");
					if (DSLite__DefaultGateway != "")	{	document.getElementById("ipv6WanDefaultGateway_DSLite").innerHTML = DSLite__DefaultGateway;	}
					else							{	document.getElementById("ipv6WanDefaultGateway_DSLite").innerHTML = I18N("j", "Not Available");	}
					try	{	onload = internetV4_showGeneral(5);	}
					catch (err) {}
					break;
			}
			$("#connection_Type").selectbox();
			$("#clone_ComputerIpByStaticIP").selectbox();
			$("#clone_ComputerIp").selectbox();
			$("#clone_ComputerIpByPPPoE").selectbox();
			$("#mtu_StaticIP").selectbox();
			$("#mtu_DynamicIP").selectbox();
			$("#addressMode_PPPoE").selectbox();
			$("#reconnectMode_PPPoE").selectbox();
			$("#mtu_PPPoE").selectbox();
			$("#addressMode_PPTP").selectbox();
			$("#reconnectMode_PPTP").selectbox();
			$("#mtu_PPTP").selectbox();
			$("#addressMode_L2TP").selectbox();
			$("#reconnectMode_L2TP").selectbox();
			$("#mtu_L2TP").selectbox();
			$("#configuration_DSLite").selectbox();
			CheckNetworkStatus();
			document.getElementById("main").style.display = "inline";
			
			lan_IPAddr = result_xml.Get("GetMultipleHNAPsResponse/GetNetworkSettingsResponse/IPAddress");
			wan_IPv6type    = result_xml.Get("GetMultipleHNAPsResponse/GetIPv6StatusResponse/IPv6_ConnectionType");
			PppoeNewSession = result_xml.Get("GetMultipleHNAPsResponse/GetIPv6PppoeSettingsResponse/IPv6_PppoeNewSession");

			/* Support disable_NAT - NAT Setting */
			if(feature_nat == "true")	NATSetting();
		}
		else	{	if (DebugMode == 1)	{	alert("[!!GetXML Error!!] Function: GetResult_2nd");	}	}
	}
	function internetV4_showGeneral(sel) {
		var staticIP = document.getElementById("generalBlock_staticIP");
		var DynamicIP = document.getElementById("generalBlock_DynamicIP");
		var PPPoE = document.getElementById("generalBlock_PPPoE");
		var PPTP = document.getElementById("generalBlock_PPTP");
		var L2TP = document.getElementById("generalBlock_L2TP");
		var DSLite = document.getElementById("generalBlock_DSLite");
		
		var adv_StaticIP = document.getElementById("advancedBlock_staticIP");
		var adv_DynamicIP = document.getElementById("advancedBlock_DynamicIP");
		var adv_PPPoE = document.getElementById("advancedBlock_PPPoE");
		var adv_PPTP = document.getElementById("advancedBlock_PPTP");
		var adv_L2TP = document.getElementById("advancedBlock_L2TP");
		var adv_DSLite = document.getElementById("advancedBlock_DSLite");
		var wanType = "";
		
		if(sel==0){
			staticIP.style.display = "inline";
			PPPoE.style.display = "none";
			PPTP.style.display = "none";
			L2TP.style.display = "none";	
			adv_StaticIP.style.display = "inline";
			adv_DynamicIP.style.display = "none";
			adv_PPPoE.style.display = "none";
			adv_PPTP.style.display = "none";
			adv_L2TP.style.display = "none";
			adv_DSLite.style.display = "none";
			
		}
		else if(sel==1){
			staticIP.style.display = "none";
			PPPoE.style.display = "none";
			PPTP.style.display = "none";
			L2TP.style.display = "none";
			adv_StaticIP.style.display = "none";
			adv_DynamicIP.style.display = "inline";
			adv_PPPoE.style.display = "none";
			adv_PPTP.style.display = "none";
			adv_L2TP.style.display = "none";
			adv_DSLite.style.display = "none";

			wanType = "DHCP"
		}
		else if(sel==2){
			staticIP.style.display = "none";
			PPPoE.style.display = "inline";
			PPTP.style.display = "none";
			L2TP.style.display = "none";
			adv_StaticIP.style.display = "none";
			adv_DynamicIP.style.display = "none";
			adv_PPPoE.style.display = "inline";
			adv_PPTP.style.display = "none";
			adv_L2TP.style.display = "none";
			adv_DSLite.style.display = "none";
			if(featureCN == 1)
			{
				document.getElementById("macAddress_PPPoE_tr").style.display = "table-row";
			}
			else
			{
				document.getElementById("macAddress_PPPoE_tr").style.display = "none";
			}
		}
		else if(sel==3){
			staticIP.style.display = "none";
			PPPoE.style.display = "none";
			PPTP.style.display = "inline";
			L2TP.style.display = "none";
			adv_StaticIP.style.display = "none";
			adv_DynamicIP.style.display = "none";
			adv_PPPoE.style.display = "none";
			adv_PPTP.style.display = "inline";
			adv_L2TP.style.display = "none";
			adv_DSLite.style.display = "none";
		}
		else if(sel==4){
			staticIP.style.display = "none";
			PPPoE.style.display = "none";
			PPTP.style.display = "none";
			L2TP.style.display = "inline";
			adv_StaticIP.style.display = "none";
			adv_DynamicIP.style.display = "none";
			adv_PPPoE.style.display = "none";
			adv_PPTP.style.display = "none";
			adv_L2TP.style.display = "inline";
			adv_DSLite.style.display = "none";
		}
		else if(sel==5){
			staticIP.style.display = "none";
			PPPoE.style.display = "none";
			PPTP.style.display = "none";
			L2TP.style.display = "none";
			adv_StaticIP.style.display = "none";
			adv_DynamicIP.style.display = "none";
			adv_PPPoE.style.display = "none";
			adv_PPTP.style.display = "none";
			adv_L2TP.style.display = "none";
			adv_DSLite.style.display = "inline";
		}
		else if(sel==6){
			staticIP.style.display = "none";
			PPPoE.style.display = "inline";
			PPTP.style.display = "none";
			L2TP.style.display = "none";
			adv_StaticIP.style.display = "none";
			adv_DynamicIP.style.display = "none";
			adv_PPPoE.style.display = "inline";
			adv_PPTP.style.display = "none";
			adv_L2TP.style.display = "none";
			adv_DSLite.style.display = "none";

			wanType = "UniPPPoE"
		}
		createOnlineHelpLink();

		/* Support VLAN */
		if(feature_vlan == "true")
		{
			VLANSetting(wanType);
		}
		/* Support disable_NAT */
		if(feature_nat == "true")
		{
			document.getElementById("staticIP_table").style.margin = "0px";
			document.getElementById("DynamicIP_table").style.margin = "0px";
			document.getElementById("PPPoE_table").style.margin = "0px";
			document.getElementById("PPTP_table").style.margin = "0px";
			document.getElementById("L2TP_table").style.margin = "0px";
			document.getElementById("DSLite_table").style.margin = "0px";

			document.getElementById("advancedBlock_disableNAT").style.display = "inline";
		}
		else
		{
			document.getElementById("advancedBlock_disableNAT").style.display = "none";
		}
	}
	
	function CheckConnectionStatus()
	{
		$.ajax({
			cache : false,
			url : "./js/CheckConnection",
			timeout : 5000,
			type : "GET",
			success : function(data) { SetXML(); },
			error : function() { document.getElementById("DetectRouterConnection").style.display = "inline"; }
		});
	}
	
	function SetXML()
	{
		document.getElementById("CreatePopAlertMessage").style.display = "inline";
		document.getElementById("waitSettingFinish").style.display = "inline";
		HNAP.GetXMLAsync("SetWanSettings", null, "GetXML", function(xml)	{	SetResult_1st(xml)	});
	}
	function SetResult_1st(result_xml)
	{
		if (result_xml != null)
		{
			// Check Combobox who selected.
			var selectedCombobox = document.getElementById("connection_Type").value;
			switch (selectedCombobox)
			{
				case "1":
					result_xml.Set("SetWanSettings/Type", "Static");
					result_xml.Set("SetWanSettings/IPAddress", document.getElementById("iPAddress_StaticIP").value);
					result_xml.Set("SetWanSettings/SubnetMask", document.getElementById("subnetMask_StaticIP").value);
					result_xml.Set("SetWanSettings/Gateway", document.getElementById("defaultGateway_StaticIP").value);
					result_xml.Set("SetWanSettings/MTU", document.getElementById("mtu_StaticIP_Input").value);
					var MaximumTransmissionUnit_StaticIP = document.getElementById("mtu_StaticIP").value;
					if (MaximumTransmissionUnit_StaticIP == 1)	{	result_xml.Set("SetWanSettings/MTU", "1500");			}
					else	{	result_xml.Set("SetWanSettings/MTU", document.getElementById("mtu_StaticIP_Input").value);	}
					result_xml.Set("SetWanSettings/ConfigDNS/Primary", document.getElementById("primaryDNSAddress_StaticIP").value);
					result_xml.Set("SetWanSettings/ConfigDNS/Secondary", document.getElementById("secondaryDNSAddress_StaticIP").value);
					result_xml.Set("SetWanSettings/MacAddress", document.getElementById("macAddress_StaticIP").value);
					break;
				case "2":
					result_xml.Set("SetWanSettings/Type", "DHCP");
					result_xml.Set("SetWanSettings/MTU", document.getElementById("mtu_DynamicIP_Input").value);
					var MaximumTransmissionUnit_DynamicIP = document.getElementById("mtu_DynamicIP").value;
					if (MaximumTransmissionUnit_DynamicIP == 1)	{	result_xml.Set("SetWanSettings/MTU", "1500");			}
					else	{	result_xml.Set("SetWanSettings/MTU", document.getElementById("mtu_DynamicIP_Input").value);	}
					result_xml.Set("SetWanSettings/HostName", document.getElementById("hostName_DynamicIP").value);
					result_xml.Set("SetWanSettings/ConfigDNS/Primary", document.getElementById("primaryDNSAddress_DynamicIP").value);
					result_xml.Set("SetWanSettings/ConfigDNS/Secondary", document.getElementById("secondaryDNSAddress_DynamicIP").value);
					result_xml.Set("SetWanSettings/MacAddress", document.getElementById("macAddress_DynamicIP").value);
					break;
				case "3":
				case "7":/* Support WAN_VLAN - PPPoE with VLAN(UniPPPoE) */
					// Get Static or Dynamic Value
					var PPPoE_Switch = document.getElementById("addressMode_PPPoE").value;
					switch (PPPoE_Switch)
					{
						case "1":
							// Dynamic
							result_xml.Set("SetWanSettings/Type", "DHCPPPPoE");
							result_xml.Set("SetWanSettings/Username", document.getElementById("userName_PPPoE").value);
							result_xml.Set("SetWanSettings/Password", document.getElementById("password_PPPoE").value);
							result_xml.Set("SetWanSettings/IPAddress", "");
							result_xml.Set("SetWanSettings/ServiceName", document.getElementById("serviceName_PPPoE").value);
							var DHCPPPPoE_ReconnectSwitch = document.getElementById("reconnectMode_PPPoE").value;
							switch (DHCPPPPoE_ReconnectSwitch)
							{
								case "1":
									// Always On
									result_xml.Set("SetWanSettings/AutoReconnect", "true");
									result_xml.Set("SetWanSettings/MaxIdleTime", "0");
									break;
								case "2":
									// On Demand
									result_xml.Set("SetWanSettings/AutoReconnect", "false");
									var maximumIdleTime = (document.getElementById("maximumIdleTime_PPPoE").value)*60;
									result_xml.Set("SetWanSettings/MaxIdleTime", maximumIdleTime);
									break;
								case "3":
									// Manual
									result_xml.Set("SetWanSettings/AutoReconnect", "false");
									result_xml.Set("SetWanSettings/MaxIdleTime", "0");
									break;
							}
							var MaximumTransmissionUnit_PPPoE = document.getElementById("mtu_PPPoE").value;
							if (MaximumTransmissionUnit_PPPoE == 1)	{	result_xml.Set("SetWanSettings/MTU", "1492");			}
							else	{	result_xml.Set("SetWanSettings/MTU", document.getElementById("mtu_PPPoE_Input").value);	}
							result_xml.Set("SetWanSettings/ConfigDNS/Primary", document.getElementById("primaryDNSAddress_PPPoE").value);
							result_xml.Set("SetWanSettings/ConfigDNS/Secondary", document.getElementById("secondaryDNSAddress_PPPoE").value);
							if(featureCN == 1) { result_xml.Set("SetWanSettings/MacAddress", document.getElementById("macAddress_PPPoE").value); }
							break;
						case "2":
							// Static
							result_xml.Set("SetWanSettings/Type", "StaticPPPoE");
							result_xml.Set("SetWanSettings/Username", document.getElementById("userName_PPPoE").value);
							result_xml.Set("SetWanSettings/Password", document.getElementById("password_PPPoE").value);
							result_xml.Set("SetWanSettings/IPAddress", document.getElementById("ipAddress_PPPoE").value);
							result_xml.Set("SetWanSettings/ServiceName", document.getElementById("serviceName_PPPoE").value);
							var StaticPPPoE_ReconnectSwitch = document.getElementById("reconnectMode_PPPoE").value;
							switch (StaticPPPoE_ReconnectSwitch)
							{
								case "1":
									// Always On
									result_xml.Set("SetWanSettings/AutoReconnect", "true");
									result_xml.Set("SetWanSettings/MaxIdleTime", "0");
									break;
								case "2":
									// On Demand
									result_xml.Set("SetWanSettings/AutoReconnect", "false");
									var maximumIdleTime = (document.getElementById("maximumIdleTime_PPPoE").value)*60;
									result_xml.Set("SetWanSettings/MaxIdleTime", maximumIdleTime);
									break;
								case "3":
									// Manual
									result_xml.Set("SetWanSettings/AutoReconnect", "false");
									result_xml.Set("SetWanSettings/MaxIdleTime", "0");
									break;
							}
							var MaximumTransmissionUnit_PPPoE = document.getElementById("mtu_PPPoE").value;
							if (MaximumTransmissionUnit_PPPoE == 1)	{	result_xml.Set("SetWanSettings/MTU", "1492");			}
							else	{	result_xml.Set("SetWanSettings/MTU", document.getElementById("mtu_PPPoE_Input").value);	}
							result_xml.Set("SetWanSettings/ConfigDNS/Primary", document.getElementById("primaryDNSAddress_PPPoE").value);
							result_xml.Set("SetWanSettings/ConfigDNS/Secondary", document.getElementById("secondaryDNSAddress_PPPoE").value);
							if(featureCN == 1) { result_xml.Set("SetWanSettings/MacAddress", document.getElementById("macAddress_PPPoE").value); }
							break;
					}
					break;
				case "4":
					// Get Static or Dynamic Value
					var PPTP_Switch = document.getElementById("addressMode_PPTP").value;
					switch (PPTP_Switch)
					{
						case "1":
							// Dynamic
							result_xml.Set("SetWanSettings/Type", "DynamicPPTP");
							result_xml.Set("SetWanSettings/ServiceName", document.getElementById("serverIPAddress_PPTP").value);
							result_xml.Set("SetWanSettings/Username", document.getElementById("userName_PPTP").value);
							result_xml.Set("SetWanSettings/Password", document.getElementById("password_PPTP").value);
							result_xml.Set("SetWanSettings/IPAddress", "");
							result_xml.Set("SetWanSettings/SubnetMask", "");
							result_xml.Set("SetWanSettings/Gateway", "");
							var DynamicPPTP_ReconnectSwitch = document.getElementById("reconnectMode_PPTP").value;
							switch (DynamicPPTP_ReconnectSwitch)
							{
								case "1":
									// Always On
									result_xml.Set("SetWanSettings/AutoReconnect", "true");
									result_xml.Set("SetWanSettings/MaxIdleTime", "0");
									break;
								case "2":
									// On Demand
									result_xml.Set("SetWanSettings/AutoReconnect", "false");
									var maximumIdleTime = (document.getElementById("maximumIdleTime_PPTP").value)*60;
									result_xml.Set("SetWanSettings/MaxIdleTime", maximumIdleTime);
									break;
								case "3":
									// Manual
									result_xml.Set("SetWanSettings/AutoReconnect", "false");
									result_xml.Set("SetWanSettings/MaxIdleTime", "0");
									break;
							}
							var MaximumTransmissionUnit_PPTP = document.getElementById("mtu_PPTP").value;
							if (MaximumTransmissionUnit_PPTP == 1)	{	result_xml.Set("SetWanSettings/MTU", "1400");			}
							else	{	result_xml.Set("SetWanSettings/MTU", document.getElementById("mtu_PPTP_Input").value);	}
							result_xml.Set("SetWanSettings/ConfigDNS/Primary", document.getElementById("primaryDNSAddress_PPTP").value);
							result_xml.Set("SetWanSettings/ConfigDNS/Secondary", document.getElementById("secondaryDNSAddress_PPTP").value);
							break;
						case "2":
							// Static
							result_xml.Set("SetWanSettings/Type", "StaticPPTP");
							result_xml.Set("SetWanSettings/ServiceName", document.getElementById("serverIPAddress_PPTP").value);
							result_xml.Set("SetWanSettings/Username", document.getElementById("userName_PPTP").value);
							result_xml.Set("SetWanSettings/Password", document.getElementById("password_PPTP").value);
							result_xml.Set("SetWanSettings/IPAddress", document.getElementById("ipAddress_PPTP").value);
							result_xml.Set("SetWanSettings/SubnetMask", document.getElementById("subnetMask_PPTP").value);
							result_xml.Set("SetWanSettings/Gateway", document.getElementById("gatewayIP_PPTP").value);
							var StaticPPTP_ReconnectSwitch = document.getElementById("reconnectMode_PPTP").value;
							switch (StaticPPTP_ReconnectSwitch)
							{
								case "1":
									// Always On
									result_xml.Set("SetWanSettings/AutoReconnect", "true");
									result_xml.Set("SetWanSettings/MaxIdleTime", "0");
									break;
								case "2":
									// On Demand
									result_xml.Set("SetWanSettings/AutoReconnect", "false");
									var maximumIdleTime = (document.getElementById("maximumIdleTime_PPTP").value)*60;
									result_xml.Set("SetWanSettings/MaxIdleTime", maximumIdleTime);
									break;
								case "3":
									// Manual
									result_xml.Set("SetWanSettings/AutoReconnect", "false");
									result_xml.Set("SetWanSettings/MaxIdleTime", "0");
									break;
							}
							var MaximumTransmissionUnit_PPTP = document.getElementById("mtu_PPTP").value;
							if (MaximumTransmissionUnit_PPTP == 1)	{	result_xml.Set("SetWanSettings/MTU", "1400");			}
							else	{	result_xml.Set("SetWanSettings/MTU", document.getElementById("mtu_PPTP_Input").value);	}
							result_xml.Set("SetWanSettings/ConfigDNS/Primary", document.getElementById("primaryDNSAddress_PPTP").value);
							result_xml.Set("SetWanSettings/ConfigDNS/Secondary", document.getElementById("secondaryDNSAddress_PPTP").value);
							break;
					}
					break;
				case "5":
					// Get Static or Dynamic Value
					var L2TP_Switch = document.getElementById("addressMode_L2TP").value;
					switch (L2TP_Switch)
					{
						case "1":
							// Dynamic
							result_xml.Set("SetWanSettings/Type", "DynamicL2TP");
							result_xml.Set("SetWanSettings/ServiceName", document.getElementById("serverIPAddress_L2TP").value);
							result_xml.Set("SetWanSettings/Username", document.getElementById("userName_L2TP").value);
							result_xml.Set("SetWanSettings/Password", document.getElementById("password_L2TP").value);
							result_xml.Set("SetWanSettings/IPAddress", "");
							result_xml.Set("SetWanSettings/SubnetMask", "");
							result_xml.Set("SetWanSettings/Gateway", "");
							var DynamicL2TP_ReconnectSwitch = document.getElementById("reconnectMode_L2TP").value;
							switch (DynamicL2TP_ReconnectSwitch)
							{
								case "1":
									// Always On
									result_xml.Set("SetWanSettings/AutoReconnect", "true");
									result_xml.Set("SetWanSettings/MaxIdleTime", "0");
									break;
								case "2":
									// On Demand
									result_xml.Set("SetWanSettings/AutoReconnect", "false");
									var maximumIdleTime = (document.getElementById("maximumIdleTime_L2TP").value)*60;
									result_xml.Set("SetWanSettings/MaxIdleTime", maximumIdleTime);
									break;
								case "3":
									// Manual
									result_xml.Set("SetWanSettings/AutoReconnect", "false");
									result_xml.Set("SetWanSettings/MaxIdleTime", "0");
									break;
							}
							var MaximumTransmissionUnit_L2TP = document.getElementById("mtu_L2TP").value;
							if (MaximumTransmissionUnit_L2TP == 1)	{	result_xml.Set("SetWanSettings/MTU", "1400");			}
							else	{	result_xml.Set("SetWanSettings/MTU", document.getElementById("mtu_L2TP_Input").value);	}
							result_xml.Set("SetWanSettings/ConfigDNS/Primary", document.getElementById("primaryDNSAddress_L2TP").value);
							result_xml.Set("SetWanSettings/ConfigDNS/Secondary", document.getElementById("secondaryDNSAddress_L2TP").value);
							break;
						case "2":
							// Static
							result_xml.Set("SetWanSettings/Type", "StaticL2TP");
							result_xml.Set("SetWanSettings/ServiceName", document.getElementById("serverIPAddress_L2TP").value);
							result_xml.Set("SetWanSettings/Username", document.getElementById("userName_L2TP").value);
							result_xml.Set("SetWanSettings/Password", document.getElementById("password_L2TP").value);
							result_xml.Set("SetWanSettings/IPAddress", document.getElementById("ipAddress_L2TP").value);
							result_xml.Set("SetWanSettings/SubnetMask", document.getElementById("subnetMask_L2TP").value);
							result_xml.Set("SetWanSettings/Gateway", document.getElementById("gatewayIP_L2TP").value);
							var StaticL2TP_ReconnectSwitch = document.getElementById("reconnectMode_L2TP").value;
							switch (StaticL2TP_ReconnectSwitch)
							{
								case "1":
									// Always On
									result_xml.Set("SetWanSettings/AutoReconnect", "true");
									result_xml.Set("SetWanSettings/MaxIdleTime", "0");
									break;
								case "2":
									// On Demand
									result_xml.Set("SetWanSettings/AutoReconnect", "false");
									var maximumIdleTime = (document.getElementById("maximumIdleTime_L2TP").value)*60;
									result_xml.Set("SetWanSettings/MaxIdleTime", maximumIdleTime);
									break;
								case "3":
									// Manual
									result_xml.Set("SetWanSettings/AutoReconnect", "false");
									result_xml.Set("SetWanSettings/MaxIdleTime", "0");
									break;
							}
							var MaximumTransmissionUnit_L2TP = document.getElementById("mtu_L2TP").value;
							if (MaximumTransmissionUnit_L2TP == 1)	{	result_xml.Set("SetWanSettings/MTU", "1400");			}
							else	{	result_xml.Set("SetWanSettings/MTU", document.getElementById("mtu_L2TP_Input").value);	}
							result_xml.Set("SetWanSettings/ConfigDNS/Primary", document.getElementById("primaryDNSAddress_L2TP").value);
							result_xml.Set("SetWanSettings/ConfigDNS/Secondary", document.getElementById("secondaryDNSAddress_L2TP").value);
							break;
						default:
							alert("Bad request");
							break;
					}
					break;
				case "6":
					result_xml.Set("SetWanSettings/Type", "DsLite");

					var dslite_Confiruration_Value = document.getElementById("configuration_DSLite").value;
					if (dslite_Confiruration_Value == "Dhcpv6Option")	{	result_xml.Set("SetWanSettings/DsLite_Configuration", "Dhcpv6Option");	}
					else												{	result_xml.Set("SetWanSettings/DsLite_Configuration", "Manual");		}
					//var combine_B4IPv4Address = "192.0.0." + document.getElementById("b4IPv4Address_DSLite").value;
					var combine_b4v4addr = document.getElementById("b4IPv4Address_DSLite").value;
					if (combine_b4v4addr != "")
					{
						result_xml.Set("SetWanSettings/DsLite_B4IPv4Address", "192.0.0." + combine_b4v4addr);
					}
					result_xml.Set("SetWanSettings/DsLite_AFTR_IPv6Address", document.getElementById("afterIPv6Address_DSLite").value);
					//result_xml.Set("SetWanSettings/DsLite_B4IPv4Address", combine_B4IPv4Address);
					break;
			}
			// Send HNAP to DUT
			HNAP.SetXMLAsync("SetWanSettings", result_xml, function(xml)	{	SetResult_2nd(xml);	});
		}
		else	{	if (DebugMode == 1)	{	alert("[!!SetXML Error!!] Function: SetResult_1st");	}	}
	}
	function SetResult_2nd(result_xml)
	{
		var SetResult_2nd = result_xml.Get("SetWanSettingsResponse/SetWanSettingsResult");
		if (SetResult_2nd == "OK" || SetResult_2nd == "REBOOT")
		{
			/* Support WAN_VLAN - Save VLAN Settings - Start */
			var vlan_result;
			if(feature_vlan == "true") { vlan_result = SaveVLAN("ROUTER"); }
			/* Support WAN_VLAN - Save VLAN Settings - End */
			/* Support disable_NAT - Save disable_NAT Settings - Start */
			var nat_result;
			if(feature_nat == "true") { nat_result = SaveNAT("ROUTER"); }
			/* Support disable_NAT - Save disable_NAT Settings - End */

			if(SetResult_2nd=="REBOOT" || vlan_result=="REBOOT" || nat_result=="REBOOT")
			{
				HNAP.GetXMLAsync("Reboot", null, "GetXML", function(xml)        {       SetResult_3rd(xml)      });
			}
			else { setTimeout("Start_reciprocal_Number_RestoreConfiguration()", 1000); }
		}
		if (SetResult_2nd == "ERROR")	{	if (DebugMode == 1)	{	alert("[!!SetXML Error!!] Function: SetResult_2nd");	}	setTimeout("waitSettingFinished()", 1000);	}
		//if (SetResult_2nd == "REBOOT")	{	setTimeout("Start_reciprocal_Number_RestoreConfiguration()", 1000);	}
	}
	function SetResult_3rd(result_xml)
	{
		if (result_xml != null) { HNAP.SetXMLAsync("Reboot", result_xml, function(xml) { SetResult_4th(xml); }); }
		else { alert("An error occurred!"); }
	}
	function SetResult_4th(result_xml)
	{
		var SetResult_4th = result_xml.Get("RebootResponse/RebootResult");
		if (SetResult_4th == "OK" || SetResult_4th == "REBOOT")
		{
			document.getElementById("dialog_msg_black2").innerHTML = I18N("j", "Rebooting");
			Start_reciprocal_Number_Reboot();
		}
		if (SetResult_4th == "ERROR")   {       if (DebugMode == 1)     {       alert("[!!SetXML Error!!] Function: SetResult_8th");    }       setTimeout("waitSettingFinished()", 1000);      }
	}
	function waitSettingFinished()	{	window.location.reload();	}
	function Start_reciprocal_Number_Reboot()
	{
		if (_ReciprocalRebootNumber >= 0)
		{
			document.getElementById("reciprocal_Number").innerHTML = _ReciprocalRebootNumber + " " + I18N("j", "Sec");
			_ReciprocalRebootNumber --;
			setTimeout("Start_reciprocal_Number_Reboot()", 1000);
		}
		else
		{
			redirectPage(null);
		}
	}

	function Start_reciprocal_Number_RestoreConfiguration()
	{
		if (_ReciprocalNumber >= 0)
		{
			document.getElementById("reciprocal_Number").innerHTML = _ReciprocalNumber + " " + I18N("j", "Sec");
			_ReciprocalNumber --;
			setTimeout("Start_reciprocal_Number_RestoreConfiguration()", 1000);
		}
		else
		{
			document.getElementById("waitSettingFinish").style.display = "none";
			document.getElementById("SuccessSettings").style.display = "inline";
		}
	}

	function returnToHome()
	{
		window.location.reload();
	}

	function StaticIPMTU_Select(status)
	{
		if (status == 1)	{	document.getElementById("mtu_StaticIP_Input").style.display = "none";	}
		else				{	document.getElementById("mtu_StaticIP_Input").style.display = "inline";	}
	}
	
	function PPPoEMTU_Select(status)
	{
		if (status == 1)	{	document.getElementById("mtu_PPPoE_Input").style.display = "none";		}
		else				{	document.getElementById("mtu_PPPoE_Input").style.display = "inline";	}
	}
	
	function DynamicIPMTU_Select(status)
	{
		if (status == 1)
		{
			document.getElementById("mtu_DynamicIP_Input").disabled = true;
			document.getElementById("mtu_DynamicIP_Input").style.display = "none";
		}
		else
		{
			document.getElementById("mtu_DynamicIP_Input").disabled = false;
			document.getElementById("mtu_DynamicIP_Input").style.display = "inline";
		}
	}
	
	function ListMACAddressByStaticIP_Select(element, status)
	{
		if (status == 0)	{	document.getElementById("macAddress_StaticIP").value = tmp_MACAddress;		}
		else	{	document.getElementById("macAddress_StaticIP").value = element.options[status].text;	}
	}
	
	function ListMACAddressByPPPoE_Select(element, status)
	{
		if (status == 0) { document.getElementById("macAddress_PPPoE").value = tmp_MACAddress;   }
		else { document.getElementById("macAddress_PPPoE").value = element.options[status].text; }
	}
	function ListMACAddress_Select(element, status)
	{
		if (status == 0)	{	document.getElementById("macAddress_DynamicIP").value = tmp_MACAddress;		}
		else	{	document.getElementById("macAddress_DynamicIP").value = element.options[status].text;	}
	}
	
	function PPTPMTU_Select(status)
	{
		if (status == 1)	{	document.getElementById("mtu_PPTP_Input").style.display = "none";	}
		else				{	document.getElementById("mtu_PPTP_Input").style.display = "inline";	}
	}
	
	function L2TPMTU_Select(status)
	{
		if (status == 1)	{	document.getElementById("mtu_L2TP_Input").style.display = "none";	}
		else				{	document.getElementById("mtu_L2TP_Input").style.display = "inline";	}
	}
	
	function PPPoE_Select_enable(status)
	{
		if (status == 1)
		{
			document.getElementById("ipAddress_tr").style.display = "none";
			document.getElementById("ipAddress_PPPoE").disabled = true;
		}
		else
		{
			document.getElementById("ipAddress_tr").style.display = "table-row";
			document.getElementById("ipAddress_PPPoE").disabled = false;
		}
	}
	
	function PPTP_Select_enable(status)
	{
		if (status == 1)
		{
			document.getElementById("ipAddress_PPTP_tr").style.display = "none";
			document.getElementById("subnetMask_PPTP_tr").style.display = "none";
			document.getElementById("gatewayIP_PPTP_tr").style.display = "none";
		}
		else
		{
			document.getElementById("ipAddress_PPTP_tr").style.display = "table-row";
			document.getElementById("subnetMask_PPTP_tr").style.display = "table-row";
			document.getElementById("gatewayIP_PPTP_tr").style.display = "table-row";
		}
	}
	
	function L2TP_Select_enable(status)
	{
		if (status == 1)
		{
			document.getElementById("ipAddress_L2TP_tr").style.display = "none";
			document.getElementById("subnetMask_L2TP_tr").style.display = "none";
			document.getElementById("gatewayIP_L2TP_tr").style.display = "none";
		}
		else
		{
			document.getElementById("ipAddress_L2TP_tr").style.display = "table-row";
			document.getElementById("subnetMask_L2TP_tr").style.display = "table-row";
			document.getElementById("gatewayIP_L2TP_tr").style.display = "table-row";
		}
	}
	
	function PPPoEReconnectMode_Select_enable(status)
	{
		switch (status)
		{
			case "1":
			case "3":
				document.getElementById("maxIdleTime_PPPoE_tr").style.display = "none";
				document.getElementById("maximumIdleTime_PPPoE").value = "0";
				break;
			case "2":
				document.getElementById("maximumIdleTime_PPPoE").disabled = false;
				document.getElementById("maximumIdleTime_PPPoE").value = "5";
				document.getElementById("maxIdleTime_PPPoE_tr").style.display = "table-row";
				break;
		}
	}
	
	function PPTPReconnectMode_Select_enable(status)
	{
		switch (status)
		{
			case "1":
			case "3":
				document.getElementById("maxIdleTime_PPTP_tr").style.display = "none";
				document.getElementById("maximumIdleTime_PPTP").value = "0";
				break;
			case "2":
				document.getElementById("maximumIdleTime_PPTP").disabled = false;
				document.getElementById("maximumIdleTime_PPTP").value = "5";
				document.getElementById("maxIdleTime_PPTP_tr").style.display = "table-row";
				break;
		}
	}
	
	function L2TPReconnectMode_Select_enable(status)
	{
		switch (status)
		{
			case "1":
			case "3":
				document.getElementById("maximumIdleTime_L2TP_tr").style.display = "none";
				document.getElementById("maximumIdleTime_L2TP").value = "0";
				break;
			case "2":
				document.getElementById("maximumIdleTime_L2TP").disabled = false;
				document.getElementById("maximumIdleTime_L2TP").value = "5";
				document.getElementById("maximumIdleTime_L2TP_tr").style.display = "table-row";
				break;
		}
	}
	
	function DSLiteConfiguration_Select(status)
	{
		if (status == 0)	{	document.getElementById("afterIPv6Address_DSLite_tr").style.display = "none";		}
		else				{	document.getElementById("afterIPv6Address_DSLite_tr").style.display = "table-row";	}
	}
	
	function CheckString(element, value)	{	element.value = element.value.replace(/\s/g, "");	}
	function CheckNetworkStatus()
	{
		var status = sessionStorage.getItem('networkStatus');
		if ((status == 1)&&(currentDevice.helpVer != ""))
		{
			document.getElementById("Get_Help").style.display = "inline";
		}
		else
		{
			document.getElementById("Get_Help").style.display = "none";
		}
	}

	/* Support WAN_VLAN function - Start */
	function VLANSetting(type)
	{
		vlanSettings = new SOAPGetVlanSettingsResponse();
		var soapAction = new SOAPAction();
		var vlan_query = soapAction.sendSOAPAction("GetVlanSettings", null, vlanSettings);

		$.when(vlan_query).done(function(obj)
		{
			var VLAN_enable = document.getElementById("show_enableVLAN");
			var VLAN_hr = document.getElementById("advancedBlock_hr");
			var VLAN = document.getElementById("advancedBlock_VLANSetting");

			$("#vlan_lan_1").selectbox('detach');
			$("#vlan_lan_2").selectbox('detach');
			$("#vlan_lan_3").selectbox('detach');
			$("#vlan_lan_4").selectbox('detach');
			$("#vlan_wlan_24").selectbox('detach');
			$("#vlan_wlan_gz_24").selectbox('detach');
			/* Support WAN_VLAN_SSID - Start */
			$("#vlan_wlan_5").selectbox('detach');
			$("#vlan_wlan_gz_5").selectbox('detach');
			/* Support WAN_VLAN_SSID - End */

			if(type=="DHCP")
			{
				VLAN_enable.style.display = "table-row";

				document.getElementById("inter_vlanid").value    = vlanSettings.interid_dhcp;
				document.getElementById("voip_vlanid").value     = vlanSettings.voipid_dhcp;
				document.getElementById("iptv_vlanid").value     = vlanSettings.iptvid_dhcp;
				document.getElementById("vlan_lan_1").value      = vlanSettings.lanport.lan1_dhcp;
				document.getElementById("vlan_lan_2").value      = vlanSettings.lanport.lan2_dhcp;
				document.getElementById("vlan_lan_3").value      = vlanSettings.lanport.lan3_dhcp;
				document.getElementById("vlan_lan_4").value      = vlanSettings.lanport.lan4_dhcp;
				document.getElementById("vlan_wlan_24").value    = vlanSettings.wlanport.wlan01_dhcp;
				document.getElementById("vlan_wlan_gz_24").value = vlanSettings.wlanport.wlan02_dhcp;
				/* Support WAN_VLAN_SSID - Start */
				document.getElementById("vlan_wlan_5").value     = vlanSettings.wlanport.wlan11_dhcp;
				document.getElementById("vlan_wlan_gz_5").value  = vlanSettings.wlanport.wlan12_dhcp;
				/* Support WAN_VLAN_SSID - End */

				if(vlanSettings.active=="1")
				{
					presetCheckBox("enableVLAN", true);
					VLAN_hr.style.display = "inline";
					VLAN.style.display = "inline";
				}
				else
				{
					presetCheckBox("enableVLAN", false);
					VLAN_hr.style.display = "none";
					VLAN.style.display = "none";
				}
			}
			else if(type=="UniPPPoE")
			{
				VLAN_enable.style.display = "none";
				
				document.getElementById("inter_vlanid").value    = vlanSettings.interid_pppoe;
				document.getElementById("voip_vlanid").value     = vlanSettings.voipid_pppoe;
				document.getElementById("iptv_vlanid").value     = vlanSettings.iptvid_pppoe;
				document.getElementById("vlan_lan_1").value      = vlanSettings.lanport.lan1_pppoe;
				document.getElementById("vlan_lan_2").value      = vlanSettings.lanport.lan2_pppoe;
				document.getElementById("vlan_lan_3").value      = vlanSettings.lanport.lan3_pppoe;
				document.getElementById("vlan_lan_4").value      = vlanSettings.lanport.lan4_pppoe;
				document.getElementById("vlan_wlan_24").value    = vlanSettings.wlanport.wlan01_pppoe;
				document.getElementById("vlan_wlan_gz_24").value = vlanSettings.wlanport.wlan02_pppoe;
				/* Support WAN_VLAN_SSID - Start */
				document.getElementById("vlan_wlan_5").value     = vlanSettings.wlanport.wlan11_pppoe;
				document.getElementById("vlan_wlan_gz_5").value  = vlanSettings.wlanport.wlan12_pppoe;
				/* Support WAN_VLAN_SSID - End */

				presetCheckBox("enableVLAN", true);
				VLAN_hr.style.display = "inline";
				VLAN.style.display = "inline";
			}
			else
			{
				presetCheckBox("enableVLAN", false);
				VLAN_enable.style.display = "none";
				VLAN_hr.style.display = "none";
				VLAN.style.display = "none";
			}

			$("#vlan_lan_1").selectbox('attach');
			$("#vlan_lan_2").selectbox('attach');
			$("#vlan_lan_3").selectbox('attach');
			$("#vlan_lan_4").selectbox('attach');
			$("#vlan_wlan_24").selectbox('attach');
			$("#vlan_wlan_gz_24").selectbox('attach');
			/* Support WAN_VLAN_SSID - Start */
			$("#vlan_wlan_5").selectbox('attach');
			$("#vlan_wlan_gz_5").selectbox('attach');
			/* Support WAN_VLAN_SSID - End */

			/* Support WAN_VLAN_SSID - Start */
			if(feature_vlanssid == "true")
			{
				document.getElementById("vlan_host_24").innerHTML = I18N("j", "Wireless 2.4G") + '<span id="vlan_ssid_24"></span>';
				document.getElementById("vlan_guest_24").innerHTML = I18N("j", "Wireless 2.4G Guest Zone") + '<span id="vlan_ssid_gz_24"></span>';
				GetSSID("RADIO_2.4GHz", "24");
				GetSSID("RADIO_5GHz", "5");
				GetSSID("RADIO_2.4GHz_Guest", "gz_24");
				GetSSID("RADIO_5GHz_Guest", "gz_5");
				document.getElementById("VLAN_Host_5").style.display = "table-row";
				document.getElementById("VLAN_Guest_5").style.display = "table-row";
			}
			/* Support WAN_VLAN_SSID - End */
		}).fail(function()
		{
		});
	}

	/* Support WAN_VLAN_SSID - Start */
	function GetSSID(id, band)
	{
		var getWLanRadioSettings = new SOAPGetWLanRadioSettings();
		var getWLanRadioSettingsResponse = new SOAPGetWLanRadioSettingsResponse();
		getWLanRadioSettings.RadioID = id;

		var soapAction = new SOAPAction();
		var result = soapAction.sendSOAPAction("GetWLanRadioSettings", getWLanRadioSettings, getWLanRadioSettingsResponse);

		$.when(result).done(function(obj)
		{
			var ssid = getWLanRadioSettingsResponse.SSID;
			var enable = getWLanRadioSettingsResponse.Enabled;

			document.getElementById("vlan_ssid_"+band).innerHTML= ":" + ssid;
			if(enable != "true")
			{
				document.getElementById("vlan_wlan_"+band).disabled  = true;
				$("#vlan_wlan_"+band).selectbox();
				$("#vlan_wlan_"+band).selectbox("disable");
			}
		}).fail(function()
		{
		});
	}
	/* Support WAN_VLAN_SSID - End */

	function SaveVLAN(mode)
	{
		// Check Combobox who selected.
		var type = document.getElementById("connection_Type").value;
		var put_VLAN = document.getElementById("enableVLAN_ck").checked;

		var xml_SetVlanSettings = HNAP.GetXML("SetVlanSettings");

		if(mode == "ROUTER" && put_VLAN == "1")
		{
			if(type == "2")//DHCP
			{
				xml_SetVlanSettings.Set("SetVlanSettings/devmode", mode);
				xml_SetVlanSettings.Set("SetVlanSettings/active", "1");
				xml_SetVlanSettings.Set("SetVlanSettings/wantype", "DHCP");

				xml_SetVlanSettings.Set("SetVlanSettings/interid_dhcp", document.getElementById("inter_vlanid").value);
				xml_SetVlanSettings.Set("SetVlanSettings/voipid_dhcp", document.getElementById("voip_vlanid").value);
				xml_SetVlanSettings.Set("SetVlanSettings/iptvid_dhcp", document.getElementById("iptv_vlanid").value);
				xml_SetVlanSettings.Set("SetVlanSettings/lanport/lan1_dhcp", document.getElementById("vlan_lan_1").value);
				xml_SetVlanSettings.Set("SetVlanSettings/lanport/lan2_dhcp", document.getElementById("vlan_lan_2").value);
				xml_SetVlanSettings.Set("SetVlanSettings/lanport/lan3_dhcp", document.getElementById("vlan_lan_3").value);
				xml_SetVlanSettings.Set("SetVlanSettings/lanport/lan4_dhcp", document.getElementById("vlan_lan_4").value);
				xml_SetVlanSettings.Set("SetVlanSettings/wlanport/wlan01_dhcp", document.getElementById("vlan_wlan_24").value);
				xml_SetVlanSettings.Set("SetVlanSettings/wlanport/wlan02_dhcp", document.getElementById("vlan_wlan_gz_24").value);
				/* Support WAN_VLAN_SSID - Start */
				if(feature_vlanssid == "true")
				{
					xml_SetVlanSettings.Set("SetVlanSettings/wlanport/wlan11_dhcp", document.getElementById("vlan_wlan_5").value);
					xml_SetVlanSettings.Set("SetVlanSettings/wlanport/wlan12_dhcp", document.getElementById("vlan_wlan_gz_5").value);
				}
				else
				{
					xml_SetVlanSettings.Set("SetVlanSettings/wlanport/wlan11_dhcp", document.getElementById("vlan_wlan_24").value);
					xml_SetVlanSettings.Set("SetVlanSettings/wlanport/wlan12_dhcp", document.getElementById("vlan_wlan_gz_24").value);
				}
				/* Support WAN_VLAN_SSID - End */
			}
			else if(type == "7")
			{
				xml_SetVlanSettings.Set("SetVlanSettings/devmode", mode);
				xml_SetVlanSettings.Set("SetVlanSettings/active", "1");
				xml_SetVlanSettings.Set("SetVlanSettings/wantype", "UniPPPoE");

				xml_SetVlanSettings.Set("SetVlanSettings/interid_pppoe", document.getElementById("inter_vlanid").value);
				xml_SetVlanSettings.Set("SetVlanSettings/voipid_pppoe", document.getElementById("voip_vlanid").value);
				xml_SetVlanSettings.Set("SetVlanSettings/iptvid_pppoe", document.getElementById("iptv_vlanid").value);
				xml_SetVlanSettings.Set("SetVlanSettings/lanport/lan1_pppoe", document.getElementById("vlan_lan_1").value);
				xml_SetVlanSettings.Set("SetVlanSettings/lanport/lan2_pppoe", document.getElementById("vlan_lan_2").value);
				xml_SetVlanSettings.Set("SetVlanSettings/lanport/lan3_pppoe", document.getElementById("vlan_lan_3").value);
				xml_SetVlanSettings.Set("SetVlanSettings/lanport/lan4_pppoe", document.getElementById("vlan_lan_4").value);
				xml_SetVlanSettings.Set("SetVlanSettings/wlanport/wlan01_pppoe", document.getElementById("vlan_wlan_24").value);
				xml_SetVlanSettings.Set("SetVlanSettings/wlanport/wlan02_pppoe", document.getElementById("vlan_wlan_gz_24").value);
				/* Support WAN_VLAN_SSID - Start */
				if(feature_vlanssid == "true")
				{
					xml_SetVlanSettings.Set("SetVlanSettings/wlanport/wlan11_pppoe", document.getElementById("vlan_wlan_5").value);
					xml_SetVlanSettings.Set("SetVlanSettings/wlanport/wlan12_pppoe", document.getElementById("vlan_wlan_gz_5").value);
				}
				else
				{
					xml_SetVlanSettings.Set("SetVlanSettings/wlanport/wlan11_pppoe", document.getElementById("vlan_wlan_24").value);
					xml_SetVlanSettings.Set("SetVlanSettings/wlanport/wlan12_pppoe", document.getElementById("vlan_wlan_gz_24").value);
				}
				/* Support WAN_VLAN_SSID - End */
			}
			else
			{
				xml_SetVlanSettings.Set("SetVlanSettings/devmode", mode);
				xml_SetVlanSettings.Set("SetVlanSettings/active", "0");
			}

			xml_SetVlanSettings.Set("SetVlanSettings/lanport/lan1", SetVlanid(document.getElementById("vlan_lan_1").value));
			xml_SetVlanSettings.Set("SetVlanSettings/lanport/lan2", SetVlanid(document.getElementById("vlan_lan_2").value));
			xml_SetVlanSettings.Set("SetVlanSettings/lanport/lan3", SetVlanid(document.getElementById("vlan_lan_3").value));
			xml_SetVlanSettings.Set("SetVlanSettings/lanport/lan4", SetVlanid(document.getElementById("vlan_lan_4").value));
			xml_SetVlanSettings.Set("SetVlanSettings/wlanport/wlan01", SetVlanid(document.getElementById("vlan_wlan_24").value));
			xml_SetVlanSettings.Set("SetVlanSettings/wlanport/wlan02", SetVlanid(document.getElementById("vlan_wlan_gz_24").value));
			/* Support WAN_VLAN_SSID - Start */
			if(feature_vlanssid == "true")
			{
				xml_SetVlanSettings.Set("SetVlanSettings/wlanport/wlan11", SetVlanid(document.getElementById("vlan_wlan_5").value));
				xml_SetVlanSettings.Set("SetVlanSettings/wlanport/wlan12", SetVlanid(document.getElementById("vlan_wlan_gz_5").value));
			}
			else
			{
				xml_SetVlanSettings.Set("SetVlanSettings/wlanport/wlan11", SetVlanid(document.getElementById("vlan_wlan_24").value));
				xml_SetVlanSettings.Set("SetVlanSettings/wlanport/wlan12", SetVlanid(document.getElementById("vlan_wlan_gz_24").value));
			}
			/* Support WAN_VLAN_SSID - End */
		}
		else
		{
			xml_SetVlanSettings.Set("SetVlanSettings/devmode", mode);
			xml_SetVlanSettings.Set("SetVlanSettings/active", "0");
		}

		var xml_SetVlanSettingsResult = HNAP.SetXML("SetVlanSettings", xml_SetVlanSettings);
		return xml_SetVlanSettingsResult.Get("SetVlanSettingsResponse/SetVlanSettingsResult");
	}

	function SetVlanid(value)
	{
		var vlanid;
		switch(value)
		{
			case "internet":
				vlanid = document.getElementById("inter_vlanid").value;
				break;
			case "voip":
				vlanid = document.getElementById("voip_vlanid").value;
				break;
			case "iptv":
				vlanid = document.getElementById("iptv_vlanid").value;
				break;
		}
		return vlanid;
	}
	/* Support WAN_VLAN function - End */

	/* Support disable_NAT function - Start */
	function NATSetting()
	{
		natSettings = new SOAPGetNATSettingsResponse();
		var soapAction = new SOAPAction();
		var nat_query = soapAction.sendSOAPAction("GetNATSettings", null, natSettings);

		$.when(nat_query).done(function(obj)
		{
			if (natSettings.Disable == "true")
				presetCheckBox("disableNAT", false);
			else
				presetCheckBox("disableNAT", true);
		}).fail(function()
		{
		});
	}

	function SaveNAT(mode)
	{
		var xml_SetNATSettings = HNAP.GetXML("SetNATSettings");
		var put_NAT = document.getElementById("disableNAT_ck").checked;
		
		if(mode == "ROUTER")
		{
			if (put_NAT == "1")
				xml_SetNATSettings.Set("SetNATSettings/Disabled", "false");
			else
				xml_SetNATSettings.Set("SetNATSettings/Disabled", "true");
		}
		else
			xml_SetNATSettings.Set("SetNATSettings/Disabled", "false");
		
		var xml_SetNATSettingsResult = HNAP.SetXML("SetNATSettings", xml_SetNATSettings);
		return xml_SetNATSettingsResult.Get("SetNATSettingsResponse/SetNATSettingsResult");
	}
	/* Support disable_NAT function - End */

</script>
<script language="JavaScript">
        // 2013/09/23 Timmy Modify
        $(function() {
			$("select").change(function () {	save_button_changed();	});
			$("input").keydown(function () {	save_button_changed();	});
        });
        function save_button_changed()
		{
			document.getElementById("Save_Disable_btn").style.display = "none";
			document.getElementById("Save_btn").style.display = "block";
			changeFlag = true;
			checkFlag = true;
			changeTimeoutAction();
		}
		function createOnlineHelpLink()
		{
			var str;
			switch($("#connection_Type").val())
			{
				case "1":
					str = 'Static IP - IPv4';
					break;
				case "2":
					str = 'Internet Setup > Dynamic IP (DCHP)';
					break;
				case "3":
					str = 'PPPoE';
					break;
				case "4":
					str = 'PPTP';
					break;
				case "5":
					str = 'L2TP';
					break;
				case "6":
					str = 'DS-Lite';
					break;
				case "7":
					str = 'Unifi-PPPoE';
					break;
			}
		
			$("#Get_Help").off('click').click(function(){
				showOnlineHelp(str);
			});
		}
</script>

<style>
#generalBlock_staticIP		{	display: none;		}
#generalBlock_PPPoE			{	display: none;		}
#generalBlock_PPTP			{	display: none;		}
#generalBlock_L2TP 			{	display: none;		}
#advancedBlock				{	display: none;		}
#advancedBlock_staticIP		{	display: none;		}
#advancedBlock_dynamicIP	{	display: inline;	}
#advancedBlock_PPPoE		{	display: none;	}
#advancedBlock_PPTP			{	display: none;	}
#advancedBlock_L2TP			{	display: none;	}
#advancedBlock_DSLite		{	display: none;	}
</style>

</head>

<body>
	<form name="internet_form" id="internet_form" method="POST" action="">
	<div id="wrapper">
		<!-------------------- Logo ------------------------->
		<div id="header"></div>
		<!-------------------- Menu ------------------------->
		<div id="menu"></div>
		<div id="menu_edge"></div>
		<!-------------------- Content ---------------------->
		<div id="content">
		<!-------------------- info ---------------------->
         <div id="info">
				<div id="FunctionName"><script>I18N("h", "Internet");</script></div>
				<div id="wallimage"><img src="image/internet_page.png" alt="" width="195" height="119"/></div>
		      	<div id="directions">
					<script>I18N("h", "Use this section to configure your Internet Connection type. There are several connection types to choose from Static IP, DHCP, PPPoE, PPTP, L2TP, and DS-Lite. If you are unsure of your connection method, please contact your Internet Service Provider. Note:  If using the PPPoE option, you will need to remove or disable any PPPoE client software on your computers.");</script>
					<label id="Get_Help" style="cursor:pointer;display:none;text-Decoration:underline"><script>I18N("h", "Click here for help.");</script></label>
				</div>
	     </div>
	     <!-------------------- funcBar ---------------------->
	     <div id="funcBar">
			<div id="pagePath">&nbsp;<script>I18N("h", "Settings");</script> >> <script>I18N("h", "Internet");</script></div>
			<ul id="rightFunc">
				<li style="display:block"><div id="Save_btn" onclick="document.getElementById('sumbit_CheckData').click();changeTimeoutAction();" style="cursor:pointer; display:none"><script>I18N("h", "Save");</script></div></li>
				<li style="display:block"><div id="Save_Disable_btn"><script>I18N("h", "Save");</script></div></li>
				<input id="sumbit_CheckData" class="submit" type="submit" value="Submit" style="display:none" />
				<li style="display:block"><a href="javascript:CheckHTMLStatus('Internet_IPv6');" style="text-decoration:none;" onclick="return confirmExit()"><div id="page_btn" class="linkstyle_1"><script>I18N("h", "IPv6");</script></div></a></li>
			</ul>
		</div>
	   	 <!-------------------- main ---------------------->
		<br />
	    <div id="main" style="display:none">
 		   <table class="block" border="0">
			   <tbody>
			   	 <tr>
			       <th><script>I18N("h", "My Internet Connection is");</script>:</th>
			       <td>
						<div class="styled-select">
							<select name="connection_Type" onChange="internetV4_showGeneral(this.selectedIndex);" id="connection_Type">
							 	<option value="1">Static IP</option>
							 	<option value="2">Dynamic IP (DHCP)</option>
							 	<option value="3">PPPoE</option>
								<option value="4">PPTP</option>
								<option value="5">L2TP</option>
								<option value="6">DS-Lite</option>
							</select>
						</div>
						<input class="styled-text" type="text" name="value_Session" size="1" id="value_Session" value="1" style="visibility: hidden; position: absolute; width: 0px; height: 0px;">
			       </td>
			     </tr>
			   </tbody>
			</table>
		<!-------------------- generalBlock_staticIP ---------------------->
		    <div id="generalBlock_staticIP">
			    <table  class="block" border="0" >
				   <tbody>
					     <tr>
					     	<th><script>I18N("h", "IP Address");</script>:</th>
					     	<td><input class="styled-text" type="text" name="iPAddress_StaticIP" size="27" maxlength="15" id="iPAddress_StaticIP" onchange="CheckString(this, this.value)"></td>
					     </tr>
					     <tr>
					     	<th><script>I18N("h", "Subnet Mask");</script>:</th>
					     	<td><input class="styled-text" type="text" name="subnetMask_StaticIP" size="27" maxlength="15" id="subnetMask_StaticIP" onchange="CheckString(this, this.value)"></td>
					     </tr>
					     <tr>
					     	<th><script>I18N("h", "Default Gateway");</script>:</th>
					     	<td><input class="styled-text" type="text" name="defaultGateway_StaticIP" size="27" maxlength="15" id="defaultGateway_StaticIP" onchange="CheckString(this, this.value)"></td>
					     </tr>
					   	 <tr>
					     	<th><script>I18N("h", "Primary DNS Server");</script>:</th>
							<td><input class="styled-text" type="text" name="primaryDNSAddress_StaticIP" size="27" maxlength="15" id="primaryDNSAddress_StaticIP" onchange="CheckString(this, this.value)"></td>
					     </tr>
				   </tbody>
				</table>
			</div>

		<!-------------------- generalBlock_Dynamic IP (DHCP)-------NONE>
		<!-------------------- generalBlock_PPPoE ---------------------->
			<div id="generalBlock_PPPoE">
			    <table  class="block">
				   <tbody>
					     <tr>
					     	<th><script>I18N("h", "Username");</script>:</th>
					     	<td><input class="styled-text" type="text" name="userName_PPPoE" size="27" maxlength="255" id="userName_PPPoE"></td>
					     </tr>
					     <tr>
					     	<th><script>I18N("h", "Password");</script>:</th>
					     	<td><input class="styled-text" type="text" name="password_PPPoE" size="27" maxlength="255" id="password_PPPoE"></td>
					     </tr>
					     <tr>
							<th><script>I18N("h", "Reconnect Mode");</script>:</th>
							<td>
								<div class="styled-select">
									<select name="reconnectMode_PPPoE" id="reconnectMode_PPPoE" onChange="PPPoEReconnectMode_Select_enable(this.value)">
										<option value="1">Always on</option>
										<option value="2" selected>On demand</option>
										<option value="3">Manual</option>
									</select>
								</div>
							</td>
						</tr>
						<tr id="maxIdleTime_PPPoE_tr">
							<th><script>I18N("h", "Maximum Idle Time");</script>:</th>
							<td><div style = "float:left"><input class="styled-text" style="width: 120px;" type="text" name="maximumIdleTime_PPPoE" id="maximumIdleTime_PPPoE" value="5" maxlength="5"></div><div style = "float:left;padding-left: 5px;padding-top: 5px;"><script>I18N("h", "minutes");</script></div></td>
						</tr>
				   </tbody>
				</table>
			</div>
		<!-------------------- generalBlock_PPTP ---------------------->
			<div id="generalBlock_PPTP">
			    <table  class="block">
				   <tbody>
				   		 <tr>
					     	<th><script>I18N("h", "PPTP Server");</script>:</th>
					     	<td><input class="styled-text" type="text" name="serverIPAddress_PPTP" size="27" id="serverIPAddress_PPTP" onchange="CheckString(this, this.value)"></td>
					     </tr>
					     <tr>
					     	<th><script>I18N("h", "Username");</script>:</th>
					     	<td><input class="styled-text" type="text" name="userName_PPTP" size="27" maxlength="128" id="userName_PPTP"></td>
					     </tr>
					     <tr>
					     	<th><script>I18N("h", "Password");</script>:</th>
					     	<td><input class="styled-text" type="text" name="password_PPTP" size="27" maxlength="128" id="password_PPTP"></td>
					     </tr>
						<tr>
					       <th><script>I18N("h", "Reconnect Mode");</script>:</th>
					       <td>
	    						<div class="styled-select">
								<select name="reconnectMode_PPTP" id="reconnectMode_PPTP" onChange="PPTPReconnectMode_Select_enable(this.value)">
								 	<option value="1">Always on</option>
								 	<option value="2" selected>On demand</option>
									<option value="3">Manual</option>
								</select>
								</div>
					       </td>
					     </tr>
					     <tr id="maxIdleTime_PPTP_tr">
					       <th><script>I18N("h", "Maximum Idle Time");</script>:</th>
					       <td><div style = "float:left"><input class="styled-text" style="width: 120px;" type="text" name="maximumIdleTime_PPTP" id="maximumIdleTime_PPTP" value="5" maxlength="5"></div><div style = "float:left;padding-left: 5px;padding-top: 5px;"><script>I18N("h", "minutes");</script></div></td>
					     </tr>
				   </tbody>
				</table> 
			</div>
		<!-------------------- generalBlock_L2TP ---------------------->
			<div id="generalBlock_L2TP">
			    <table  class="block">
				   <tbody>
				   		 <tr>
					     	<th><script>I18N("h", "L2TP Server");</script>:</th>
					     	<td><input class="styled-text" type="text" name="serverIPAddress_L2TP" size="27" id="serverIPAddress_L2TP" onchange="CheckString(this, this.value)"></td>
					     </tr>
					     <tr>
					     	<th><script>I18N("h", "Username");</script>:</th>
					     	<td><input class="styled-text" type="text" name="userName_L2TP" size="27" maxlength="128" id="userName_L2TP"></td>
					     </tr>
					     <tr>
					     	<th><script>I18N("h", "Password");</script>:</th>
					     	<td><input class="styled-text" type="text" name="password_L2TP" size="27" maxlength="128" id="password_L2TP"></td>
					     </tr>
						 <tr>
					       <th><script>I18N("h", "Reconnect Mode");</script>:</th>
					       <td>
	    						<div class="styled-select">
								<select name="reconnectMode_L2TP" id="reconnectMode_L2TP" onChange="L2TPReconnectMode_Select_enable(this.value)">
								 	<option value="1">Always on</option>
								 	<option value="2" selected>On demand</option>
									<option value="3">Manual</option>
								</select>
								</div>
					       </td>
					     </tr>
					  	 <tr id="maximumIdleTime_L2TP_tr">
					       <th><script>I18N("h", "Maximum Idle Time");</script>:</th>
					       <td><div style = "float:left"><input class="styled-text" style="width: 120px;" type="text" name="maximumIdleTime_L2TP" size="15" id="maximumIdleTime_L2TP" value="5" maxlength="5"></div><div style = "float:left;padding-left: 5px;padding-top: 5px;"><script>I18N("h", "minutes");</script></div></td>
					     </tr>
				   </tbody>
				</table>
			</div>
		<!-------------------- generalBlock_DSLite------------------NONE---->
	    <!-----------------------------------Advanced Settings------------------------------------------------->
		    <div class="advButton" onclick="showAdv('advancedBlock');"><script>I18N("h", "Advanced Settings");</script>...</div>
		    <hr />
			<div id="advancedBlock">
			    <!-------------------- advancedBlock_staticIP ---------------------->
			    <div id="advancedBlock_staticIP">
				    <table  id="staticIP_table" class="block" border="0">
					   <tbody>
						     <tr>
						       <th><script>I18N("h", "Secondary DNS Server");</script>:</th>
						       <td width="200px"><input class="styled-text" type="text" name="secondaryDNSAddress_StaticIP" size="27" maxlength="15" id="secondaryDNSAddress_StaticIP" onchange="CheckString(this, this.value)"></td>
						       <td></td>
						     </tr>
							 <tr>
						       <th><script>I18N("h", "MTU");</script>:</th>
						       <td>
		    						<div class="styled-select">
										<select name="mtu_StaticIP" id="mtu_StaticIP" onChange="StaticIPMTU_Select(this.value)">
										 	<option value="1" selected>Auto</option>
										 	<option value="2">Manual</option>
										</select>
									</div>
						       </td>
						       <td>
						       		<input class="styled-text" type="text" name="mtu_StaticIP_Input" size="3" maxlength="5" id="mtu_StaticIP_Input" value="1500" style="display: none;" onchange="CheckString(this, this.value)">
						       </td>
						     </tr>
						     <tr>
						       <th><script>I18N("h", "Mac Address Clone");</script>:</th>
						       <td><input class="styled-text" type="text" name="macAddress_StaticIP" size="27" maxlength="17" id="macAddress_StaticIP" onchange="CheckString(this, this.value)"></td>
						       <td>
	        						<div class="styled-select">
										<select name="clone_ComputerIpByStaticIP" id="clone_ComputerIpByStaticIP" onChange="ListMACAddressByStaticIP_Select(this, this.value)">
										 	<option value="0">&lt;&lt; MAC Address</option>
										</select>
									</div>
						       </td>
						     </tr>
					   </tbody>
					</table>
				</div>
		    <!-------------------- advancedBlock_Dynamic IP (DHCP)---------------------->
			    <div id="advancedBlock_DynamicIP">
				    <table  id="DynamicIP_table" class="block" border="0">
					   <tbody>
						     <tr>
						       <th><script>I18N("h", "Host Name");</script>:</th>
						       <td width="200px"><input class="styled-text" type="text" name="hostName_DynamicIP" size="27" maxlength="25" id="hostName_DynamicIP"></td>
						       <td></td>
						     </tr>
						     <tr>
						       <th><script>I18N("h", "Primary DNS Server");</script>:</th>
						       <td><input class="styled-text" type="text" name="primaryDNSAddress_DynamicIP" size="27" maxlength="15" id="primaryDNSAddress_DynamicIP" onchange="CheckString(this, this.value)"></td>
						       <td></td>
						     </tr>
						     <tr>
						       <th><script>I18N("h", "Secondary DNS Server");</script>:</th>
						       <td><input class="styled-text" type="text" name="secondaryDNSAddress_DynamicIP" size="27" maxlength="15" id="secondaryDNSAddress_DynamicIP" onchange="CheckString(this, this.value)"></td>
						       <td></td>
						     </tr>
						   	 <tr>
						       <th><script>I18N("h", "MTU");</script>:</th>
						       <td>
	        						<div class="styled-select">
									<select name="mtu_DynamicIP" id="mtu_DynamicIP" onChange="DynamicIPMTU_Select(this.value)">
									 	<option value="1" selected>Auto</option>
									 	<option value="2">Manual</option>
									</select>
									</div>
						       </td>
						       <td><input class="styled-text" type="text" name="mtu_DynamicIP_Input" size="3" maxlength="5" id="mtu_DynamicIP_Input" value="1500" style="display: none;" onchange="CheckString(this, this.value)"></td>
						     </tr>
						     <tr>
						       <th><script>I18N("h", "Mac Address Clone");</script>:</th>
						       <td><input class="styled-text" type="text" name="macAddress_DynamicIP" size="27" maxlength="17" id="macAddress_DynamicIP" onchange="CheckString(this, this.value)"></td>
						       <td>
	        						<div class="styled-select">
										<select name="clone_ComputerIp" id="clone_ComputerIp" onChange="ListMACAddress_Select(this, this.value)">
										 	<option value="0">&lt;&lt; MAC Address</option>
										</select>
									</div>
						       </td>
						     </tr>
						<!-------------------- VLANSetting-show_enableVLAN ------------------>
						<tr id="show_enableVLAN" style="display:none">
							<th><script>I18N("h", "VLAN");</script>:</th>
							<td><div id="enableVLAN"><input type="checkbox" name="enableVLAN" id="enableVLAN_ck"></div></td>
						</tr>
					   </tbody>
					</table>
				</div>
		    <!-------------------- advancedBlock_PPPoE  ---------------------->
			    <div id="advancedBlock_PPPoE">
				    <table  id="PPPoE_table" class="block" border="0">
					   <tbody>
						   	 <tr>
						       <th><script>I18N("h", "Address Mode");</script>:</th>
						       <td width="200px">
	        						<div class="styled-select">
										<select name="addressMode_PPPoE" id="addressMode_PPPoE" onChange="PPPoE_Select_enable(this.value)">
										 	<option value="1">Dynamic IP</option>
										 	<option value="2">Static IP</option>
										</select>
									</div>
						       </td>
						       <td></td>
						     </tr>
						     <tr id="ipAddress_tr"  style="display:none;">
						       <th><script>I18N("h", "IP Address");</script>:</th>
						       <td><input class="styled-text" type="text" name="ipAddress_PPPoE" id="ipAddress_PPPoE" size="27" maxlength="15" id="ipAddress" onchange="CheckString(this, this.value)"></td>
						       <td></td>
						     </tr>
						     <tr>
						       <th><script>I18N("h", "Service Name");</script>:</th>
						       <td><input class="styled-text" type="text" name="serviceName_PPPoE" size="27" maxlength="25" id="serviceName_PPPoE"></td>
						       <td></td>
						     </tr>
							 <tr>
						       <th><script>I18N("h", "Primary DNS Server");</script>:</th>
						       <td><input class="styled-text" type="text" name="primaryDNSAddress_PPPoE" size="27" maxlength="15" id="primaryDNSAddress_PPPoE" onchange="CheckString(this, this.value)"></td>
						       <td></td>
						     </tr>
							 <tr>
						       <th><script>I18N("h", "Secondary DNS Server");</script>:</th>
						       <td><input class="styled-text" type="text" name="secondaryDNSAddress_PPPoE" size="27" maxlength="15" id="secondaryDNSAddress_PPPoE" onchange="CheckString(this, this.value)"></td>
						       <td></td>
						     </tr>
							 <tr>
						       <th><script>I18N("h", "MTU");</script>:</th>
						       <td>
	        						<div class="styled-select">
									<select name="mtu_PPPoE" id="mtu_PPPoE" onChange="PPPoEMTU_Select(this.value)">
									 	<option value="1" selected>Auto</option>
									 	<option value="2">Manual</option>
									</select>
									</div>
									<td><input class="styled-text" type="text" name="mtu_PPPoE_Input" size="3" maxlength="5" id="mtu_PPPoE_Input" value="1492" style="display: none;"></td> 
						       </td>
						     </tr>
						     <tr id="macAddress_PPPoE_tr"  style="display:none;">
							 	<th><script>I18N("h", "Mac Address Clone");</script>:</th>
							 	<td><input class="styled-text" type="text" name="macAddress_PPPoE" size="27" maxlength="17" id="macAddress_PPPoE" onchange="CheckString(this, this.value)"></td>
							 	<td>
							 		<div class="styled-select">
							 			<select name="clone_ComputerIpByPPPoE" id="clone_ComputerIpByPPPoE" onChange="ListMACAddressByPPPoE_Select(this, this.value)">
							 				<option value="0">&lt;&lt; MAC Address</option>
							 			</select>
							 		</div>
							 	</td>
						     </tr>

					   </tbody>
					</table>
				</div>
			<!-------------------- advancedBlock_PPTP  ---------------------->
			    <div id="advancedBlock_PPTP">
				    <table  id="PPTP_table" class="block" border="0">
					   <tbody>
						   	 <tr>
						       <th><script>I18N("h", "Address Mode");</script>:</th>
						       <td width="200px">
	        						<div class="styled-select">
										<select name="addressMode_PPTP" id="addressMode_PPTP" onChange="PPTP_Select_enable(this.value)">
										 	<option value="1">Dynamic IP</option>
										 	<option value="2">Static IP</option>
										</select>
									</div>
						       </td>
						       <td></td>
						     </tr>
						     <tr id="ipAddress_PPTP_tr" style="display: none;">
						       <th><script>I18N("h", "PPTP IP Address");</script>:</th>
						       <td><input class="styled-text" type="text" name="ipAddress_PPTP" size="27" maxlength="15" id="ipAddress_PPTP" onchange="CheckString(this, this.value)"></td>
						       <td></td>
						     </tr>
						     <tr id="subnetMask_PPTP_tr" style="display: none;">
						       <th><script>I18N("h", "PPTP Subnet Mask");</script>:</th>
						       <td><input class="styled-text" type="text" name="subnetMask_PPTP" size="27" maxlength="15" id="subnetMask_PPTP" onchange="CheckString(this, this.value)"></td>
						       <td></td>
						     </tr>
						   	 <tr id="gatewayIP_PPTP_tr" style="display: none;">
						       <th><script>I18N("h", "PPTP Gateway IP Address");</script>:</th>
							   <td><input class="styled-text" type="text" name="gatewayIP_PPTP" size="27" maxlength="15" id="gatewayIP_PPTP" onchange="CheckString(this, this.value)"></td>
							   <td></td>
						     </tr>
							 <tr>
						       <th><script>I18N("h", "Primary DNS Server");</script>:</th>
						       <td><input class="styled-text" type="text" name="primaryDNSAddress_PPTP" size="27" maxlength="15" id="primaryDNSAddress_PPTP" onchange="CheckString(this, this.value)"></td>
						       <td></td>
						     </tr> 
							 <tr>
						       <th><script>I18N("h", "Secondary DNS Server");</script>:</th>
						       <td><input class="styled-text" type="text" name="secondaryDNSAddress_PPTP" size="27" maxlength="15" id="secondaryDNSAddress_PPTP" onchange="CheckString(this, this.value)"></td>
						       <td></td>
						     </tr> 
							 <tr>
						       <th><script>I18N("h", "MTU");</script>:</th>
						       <td>
	        						<div class="styled-select">
									<select name="mtu_PPTP" id="mtu_PPTP" onChange="PPTPMTU_Select(this.value)">
									 	<option value="1" selected>Auto</option>
									 	<option value="2">Manual</option>
									</select>
									</div>
						       </td>
						       <td><input class="styled-text" type="text" name="mtu_PPTP_Input" size="3" maxlength="5" id="mtu_PPTP_Input" value="1400" style="display: none;"></td>
						     </tr>
					   </tbody>
					</table>
				</div>
			<!-------------------- advancedBlock_L2TP  ---------------------->
			    <div id="advancedBlock_L2TP">
				    <table  id="L2TP_table" class="block" border="0">
					   <tbody>
						   	 <tr>
						       <th><script>I18N("h", "Address Mode");</script>:</th>
						       <td width="200px">
	        						<div class="styled-select">
										<select name="addressMode_L2TP" id="addressMode_L2TP" onChange="L2TP_Select_enable(this.value)">
										 	<option value="1">Dynamic IP</option>
										 	<option value="2">Static IP</option>
										</select>
									</div>
						       </td>
						       <td></td>
						     </tr>
						     <tr id="ipAddress_L2TP_tr" style="display: none;">
						       <th><script>I18N("h", "L2TP IP Address");</script>:</th>
						       <td><input class="styled-text" type="text" name="ipAddress_L2TP" size="27" maxlength="15" id="ipAddress_L2TP" onchange="CheckString(this, this.value)"></td>
						       <td></td>
						     </tr>
						     <tr id="subnetMask_L2TP_tr" style="display: none;">
						       <th><script>I18N("h", "L2TP Subnet Mask");</script>:</th>
						       <td><input class="styled-text" type="text" name="subnetMask_L2TP" size="27" maxlength="15" id="subnetMask_L2TP" onchange="CheckString(this, this.value)"></td>
						       <td></td>
						     </tr>
						   	 <tr id="gatewayIP_L2TP_tr" style="display: none;">
						       <th><script>I18N("h", "L2TP Gateway IP Address");</script>:</th>
							   <td><input class="styled-text" type="text" name="gatewayIP_L2TP" size="27" maxlength="15" id="gatewayIP_L2TP" onchange="CheckString(this, this.value)"></td>
							   <td></td>
						     </tr>
							 <tr>
						       <th><script>I18N("h", "Primary DNS Server");</script>:</th>
						       <td><input class="styled-text" type="text" name="primaryDNSAddress_L2TP" size="27" maxlength="15" id="primaryDNSAddress_L2TP" onchange="CheckString(this, this.value)"></td>
						       <td></td>
						     </tr> 
							 <tr>
						       <th><script>I18N("h", "Secondary DNS Server");</script>:</th>
						       <td><input class="styled-text" type="text" name="secondaryDNSAddress_L2TP" size="27" maxlength="15" id="secondaryDNSAddress_L2TP" onchange="CheckString(this, this.value)"></td>
						       <td></td>
						     </tr> 
							 <tr>
						       <th><script>I18N("h", "MTU");</script>:</th>
						       <td>
	        						<div class="styled-select">
									<select name="mtu_L2TP" id="mtu_L2TP" onChange="L2TPMTU_Select(this.value)">
									 	<option value="1" selected>Auto</option>
									 	<option value="2">Manual</option>
									</select>
									</div>
						       </td>
						       <td><input class="styled-text" type="text" name="mtu_L2TP_Input" size="3" maxlength="5" id="mtu_L2TP_Input" value="1400" style="display: none;"></td>
						     </tr>
					   </tbody>
					</table>
				</div>
			<!-------------------- advancedBlock_DS-Lite  ---------------------->
			    <div id="advancedBlock_DSLite">
				    <table  id="DSLite_table" class="block" border="0">
					   <tbody>
						     <tr>
						       <th><script>I18N("h", "DS-Lite Configuration");</script>:</th>
						       <td>
	      							<div class="styled-select">
										<select name="configuration_DSLite" id="configuration_DSLite" onChange="DSLiteConfiguration_Select(this.value)">
											<option value="0">DS-Lite DHCPv6 Option</option>
											<option value="1">Manual Configuration</option>
										</select>
									</div>
						       </td>
						     <tr id="afterIPv6Address_DSLite_tr" style="display: none;">
						       <th><script>I18N("h", "AFTR IPv6 Address");</script>:</th>
						       <td><input class="styled-text" type="text" name="afterIPv6Address_DSLite" size="27" maxlength="39" id="afterIPv6Address_DSLite" onchange="CheckString(this, this.value)"></td>
						     </tr>
						     <tr>
						       <th><script>I18N("h", "B4 IPv4 Address");</script>:</th>
						       <td>192.0.0.&nbsp;<input class="styled-text" style="width: 50px;" type="text" name="b4IPv4Address_DSLite" size="3" maxlength="3" id="b4IPv4Address_DSLite" onchange="CheckString(this, this.value)"></td>
						     </tr>
						   	 <tr>
						       <th><script>I18N("h", "WAN IPv6 Address");</script>:</th>
							   <td><label name="wanIPv6Address_DSLite" id="wanIPv6Address_DSLite"><script>I18N("h", "Not Available");</script></label></td>
						     </tr>
						   	 <tr>
						       <th><script>I18N("h", "IPv6 WAN Default Gateway");</script>:</th>
							   <td><label name="ipv6WanDefaultGateway_DSLite" id="ipv6WanDefaultGateway_DSLite"><script>I18N("h", "Not Available");</script></label></td>
						     </tr>
					   </tbody>
					</table> 
				</div>
				<!-------------------- advancedBlock_disableNAT  ------------------>
				<div id="advancedBlock_disableNAT" style="display:none">
					<table  class="block" border="0">
						<tbody>
							<th><script>I18N("h", "NAT");</script>:</th>
							<td><div id="disableNAT"><input type="checkbox" name="disableNAT" id="disableNAT_ck"></div></td>
						</tbody>
					</table>
				</div>
				<!-------------------- advancedBlock_VLANSetting  ------------------>
				<div id="advancedBlock_hr" style="display:none">
					<hr />
				</div>
				<div id="advancedBlock_VLANSetting" style="display:none">
					<table  class="block" border="0">
						<tbody>
							<tr>
								<td><div class ="title"><script>I18N("h", "VLAN BRIDGE");</script></div></td>
							</tr>
							<tr>
								<th><script>I18N("h", "Internet VLan ID");</script>:</th>
								<td><input class="styled-text" type="text" name="inter_vlanid" size="27" maxlength="4" id="inter_vlanid" >&nbsp;&nbsp;(2~4095)</td>
							</tr>
							<tr>
								<th><script>I18N("h", "IPTV VLan ID");</script>:</th>
								<td><input class="styled-text" type="text" name="iptv_vlanid" size="27" maxlength="4" id="iptv_vlanid" >&nbsp;&nbsp;(2~4095)</td>
							</tr>
							<tr>
								<th><script>I18N("h", "VoIP VLan ID");</script>:</th>
								<td><input class="styled-text" type="text" name="voip_vlanid" size="27" maxlength="4" id="voip_vlanid" >&nbsp;&nbsp;(2~4095)</td>
							</tr>
						</tbody>
					</table>
					<table class="mainTable" border="0" cellspacing="0" style="top:5px">
						<thead>
							<tr>
								<th style="width:690px"><script>I18N("h", "Interface");</script></th>
								<th><script>I18N("h", "WAN Connection");</script></th>
							</tr>
						</thead>
						<tbody>
							<tr>
								<td><script>I18N("h", "LAN Port1");</script></td>
								<td>
									<div class="styled-select">
										<select id="vlan_lan_1" name="vlan_lan_1">
											<option value="internet">Internet</option>
											<option value="iptv">IPTV</option>
											<option value="voip">VoIP</option>
										</select>
									</div>
								</td>
							</tr>
							<tr>
								<td><script>I18N("h", "LAN Port2");</script></td>
								<td>
									<div class="styled-select">
										<select id="vlan_lan_2" name="vlan_lan_2">
											<option value="internet">Internet</option>
											<option value="iptv">IPTV</option>
											<option value="voip">VoIP</option>
										</select>
									</div>
								</td>
							</tr>
							<tr>
								<td><script>I18N("h", "LAN Port3");</script></td>
								<td>
									<div class="styled-select">
										<select id="vlan_lan_3" name="vlan_lan_3">
											<option value="internet">Internet</option>
											<option value="iptv">IPTV</option>
											<option value="voip">VoIP</option>
										</select>
									</div>
								</td>
							</tr>
							<tr>
								<td><script>I18N("h", "LAN Port4");</script></td>
								<td>
									<div class="styled-select">
										<select id="vlan_lan_4" name="vlan_lan_4">
											<option value="internet">Internet</option>
											<option value="iptv">IPTV</option>
											<option value="voip">VoIP</option>
										</select>
									</div>
								</td>
							</tr>
							<tr>
								<td id="vlan_host_24"><script>I18N("h", "Wireless");</script></td>
								<td>
									<div class="styled-select">
										<select id="vlan_wlan_24" name="vlan_wlan_24">
											<option value="internet">Internet</option>
											<option value="iptv">IPTV</option>
											<option value="voip">VoIP</option>
										</select>
									</div>
								</td>
							</tr>
							<tr>
								<td id="vlan_guest_24"><script>I18N("h", "Wireless Guest Zone");</script></td>
								<td>
									<div class="styled-select">
										<select id="vlan_wlan_gz_24" name="vlan_wlan_gz_24">
											<option value="internet">Internet</option>
											<option value="iptv">IPTV</option>
											<option value="voip">VoIP</option>
										</select>
									</div>
								</td>
							</tr>
							<!-------------------- advancedBlock_VLANSetting_SSID_Start ------------------>
							<tr id="VLAN_Host_5" style="display:none">
								<td><script>I18N("h", "Wireless 5G");</script><span id="vlan_ssid_5"></span></td>
								<td>
									<div class="styled-select">
										<select id="vlan_wlan_5" name="vlan_wlan_5">
											<option value="internet">Internet</option>
											<option value="iptv">IPTV</option>
											<option value="voip">VoIP</option>
										</select>
									</div>
								</td>
							</tr>
							<tr id="VLAN_Guest_5" style="display:none">
								<td><script>I18N("h", "Wireless 5G Guest Zone");</script><span id="vlan_ssid_gz_5"></span></td>
								<td>
									<div class="styled-select">
										<select id="vlan_wlan_gz_5" name="vlan_wlan_gz_5">
											<option value="internet">Internet</option>
											<option value="iptv">IPTV</option>
											<option value="voip">VoIP</option>
										</select>
									</div>
								</td>
							</tr>
							<!-------------------- advancedBlock_VLANSetting_SSID_End ------------------>
						</tbody>
					</table>
				</div>
			</div>
		</div>
		<div id="CreatePopAlertMessage" style="display:none">
			<div id="AlertPopRect">
			<div id="AlertPopBody">
				<table class="myAlertPop_table_b" id="waitSettingFinish" border="0" cellspacing="0">
				   <tbody>
						 <tr>
						 	<td>
								<center><div id="Loading_pop_image2"></div></center>
							</td>
						 </tr>
						 <tr>
						 	<td label id="reciprocal_Number"></label></td>
						 </tr>
						 <tr>
						 	<td id="dialog_msg_black2"><script>I18N("h", "Your changes are being saved.");</script></td>
						 </tr>
				   </tbody>
				</table>
				<table class="myAlertPop_table_b" id="SuccessSettings" border="0" cellspacing="0"  style="display:none">
				   <tbody>
						 <tr>
						 	<td>
								<center><div id="Information_pop_image"></div></center>
							</td>
						 </tr>
						 <tr>
							 <td>
							 	<div id="dialog_msg_black"><script>I18N("h", "The new settings have been saved.");</script></div>
							 </td>
						 </tr>
						 <tr>
							 <td>
							 	<center><div id="Confirm_btn" onclick="returnToHome()" style="cursor:pointer"><script>I18N("h", "OK");</script></div></center>
							 </td>
						 </tr>
				   </tbody>
				</table>
			</div>
			</div>
		</div>
		<!-- Detect Router Connection, Timmy Add 2013/08/15 -->
		<div id="DetectRouterConnection" style="display:none"></div>
		<div id="footer">
			<div id="copyright"><script>I18N("h", "COPYRIGHT");</script></div>
		</div>
	</div>
	</form>
	<script type="text/javascript" charset="utf-8">
		$(document).ready( function() {
			//placeholder
			$("#serverIPAddress_PPTP").attr("placeholder", I18N("j", "IP or Domain name"));
			$("#serverIPAddress_L2TP").attr("placeholder", I18N("j", "IP or Domain name"));
			//$.Placeholder.init();	//for IE

			
			function check_session(session)
			{
				if(session != "3" && session != "7" && wan_IPv6type == "IPv6_PPPoE" && PppoeNewSession == "SharedWithIPv4")
					return false;
				
				else
					return true;	
			}
			
			function check_dslite(session)
			{
				if(session == "6" && (wan_IPv6type == "IPv6_IPv6InIPv4Tunnel" || wan_IPv6type == "IPv6_6To4" || wan_IPv6type == "IPv6_6RD" || wan_IPv6type == "IPv6_LinkLocalOnly"))
					return false;			
				else
					return true;
			}
			
			/* Note: it should return "" if it does not have error check message. */
			$.validator.addMethod("checkSetValues", function( value, element ) {
				var elem_id = element.id;
				var error_msg = "";
				var connect_type = document.getElementById("connection_Type").value;

				/* check session first */
				if(!check_session(connect_type))
				{
					if(elem_id == "value_Session")
						return I18N("j","IPv6 PPPoE is share with IPv4 PPPoE. Please change IPv6 WAN protocol to PPPoE at first.");
				}
				else if(!check_dslite(connect_type))
				{
					if(elem_id == "value_Session")
						return I18N("j","Please choose one IPv6 connection type besides Link-Local Only, 6to4, 6rd, and IPv6 in IPv4 Tunnel !");
				}
				else
				{
					/* if session is valid, check ipv4 settings */
					switch(connect_type)
					{
						case "1": /* static ip */
							var staticip = document.getElementById("iPAddress_StaticIP").value;
							var pristaticdns = document.getElementById("primaryDNSAddress_StaticIP").value;
							var netmask = document.getElementById("subnetMask_StaticIP").value;
							var mask = COMM_IPv4MASK2INT(netmask);
						
							if(elem_id == "iPAddress_StaticIP")
							{
								if(value == "" || value == null)
									return I18N("j","Please enter an IP address.");
								else
								{
									if(!COMM_ValidV4Format(value) || !COMM_ValidV4Addr(value))
										return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)");
									
									if(netmask != "" && (COMM_IPv4NETWORK(value, mask) == COMM_IPv4NETWORK(lan_IPAddr, mask)))
										return I18N("j", "The network id is the same with LAN.");
								}
							}
							
							if(elem_id=="subnetMask_StaticIP")
							{
								if(value == "" || value == null)
									return I18N("j","Please enter a subnet mask.");
								else
								{
									var mask = COMM_IPv4MASK2INT(value);
									if(mask <= 0 || mask > 32)
										return I18N("j","Please enter a valid netmask. (e.g. 255.255.255.0)");
									if(mask < 8)
										return I18N("j", "The router would not support the subnet mask which length is less than Class A.");
								}
							}
							
							if(elem_id == "defaultGateway_StaticIP")
							{
								if(value == "" || value == null)
									return I18N("j","Please enter a gateway address.");
								else
								{
									if(netmask != "")
									{
										if(!COMM_ValidV4HOST(value, mask))
											return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)");
										
										if(staticip != "")
										{
											if(value == staticip)
												return I18N("j", "Please enter a valid gateway address. (e.g. 192.168.0.1)");
												
											if(COMM_IPv4NETWORK(value, mask) != COMM_IPv4NETWORK(staticip, mask))
												return I18N("j", "The default gateway should be in the same network.");
										}
									}
								}
							}
							
							if(elem_id == "primaryDNSAddress_StaticIP")
							{
								if(value == "" || value == null)
									return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)");
								else
								{
									if(!COMM_ValidV4Addr(value))
										return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)");
									
									if(staticip != "" && value == staticip)
										return I18N("j", "The dns server cannot be equal to the IP address.");
								}
							}
							
							if(elem_id == "secondaryDNSAddress_StaticIP" && value != "")
							{
								if(pristaticdns == "" || pristaticdns == null)
									return I18N("j","Please enter a primary dns server");
								
								if(!COMM_ValidV4Addr(value))
									return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)");
																
								if(staticip != "" && value == staticip)
									return I18N("j", "The dns server cannot be equal to the IP address.");
							}
							
							if(elem_id=="mtu_StaticIP_Input" && $("#mtu_StaticIP")[0].value=="2")
								if(!COMM_IsInteger(value) || value < 1280 || 1500 < value)
									return I18N("j", "The MTU value should be 1280 ~ 1500.");

							if(elem_id=="macAddress_StaticIP" && value != "" && (value=="00:00:00:00:00:00" || !COMM_IsMAC(value)))
								return I18N("j", "Text field contains illegal characters.");
							break;
						
						case "2": /* DHCP */
							var PriDHCPDNS = document.getElementById("primaryDNSAddress_DynamicIP").value;
							
							if(elem_id == "primaryDNSAddress_DynamicIP" && value != "" && value != "0.0.0.0")
							{
								if(!COMM_ValidV4Addr(value))
									return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)");
							}
							
							if(elem_id == "secondaryDNSAddress_DynamicIP" && value != "" && value != "0.0.0.0")
							{
								if(PriDHCPDNS == "" || PriDHCPDNS == null)
									return I18N("j","Please enter a primary dns server");
								
								if(!COMM_ValidV4Addr(value))
									return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)");
									
								if(value == PriDHCPDNS)
									return I18N("j","Secondary DNS server should not be the same as Primary DNS server.");
							}
						
							if(elem_id=="mtu_DynamicIP_Input" && $("#mtu_DynamicIP")[0].value=="2")
								if(!COMM_IsInteger(value) || value < 1280 || 1500 < value)
									return I18N("j", "The MTU value should be 1280 ~ 1500.");

							if(elem_id=="macAddress_DynamicIP" && value != "" && (value=="00:00:00:00:00:00" || !COMM_IsMAC(value)))
								return I18N("j", "Text field contains illegal characters.");
							break;
						
						case "3": /* pppoe */
						case "7": /* Support WAN_VLAN - PPPoE with VLAN(UniPPPoE) */
							var PPPoEStatus = document.getElementById("addressMode_PPPoE").value;
							var PriPPPoEDNS = document.getElementById("primaryDNSAddress_PPPoE").value;
							
							if(elem_id == "userName_PPPoE" && (value == "" || value == null))
								return I18N("j","Please enter a username.");
							
							//if(elem_id == "password_PPPoE" && (value == "" || value == null))
							//	return I18N("j","Please enter a password.");
							
							if(elem_id == "primaryDNSAddress_PPPoE" && value != "" && value != "0.0.0.0")
							{
								if(!COMM_ValidV4Addr(value))
									return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)");
							}
							
							if(elem_id == "secondaryDNSAddress_PPPoE" && value != "" && value != "0.0.0.0")
							{
								if(PriPPPoEDNS == "" || PriPPPoEDNS == null)
									return I18N("j","Please enter a primary dns server");
								
								if(!COMM_ValidV4Addr(value))
									return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)");
								
									
								if(value == PriPPPoEDNS)
									return I18N("j","Secondary DNS server should not be the same as Primary DNS server.");
							}
							
							if(PPPoEStatus == "2" && elem_id == "ipAddress_PPPoE")
							{
								if(value == "" || value == null)
									return I18N("j","Please enter an IP address.");
								else
								{
									if(!COMM_ValidV4Format(value) || !COMM_ValidV4Addr(value))
										return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)");
								}
							}
							
							if(elem_id=="mtu_PPPoE_Input" && $("#mtu_PPPoE")[0].value=="2")
								if(!COMM_IsInteger(value) || value < 1280 || 1492 < value)
									return I18N("j", "The MTU value should be 1280 ~ 1492.");

							if(elem_id=="maximumIdleTime_PPPoE")
							{
								if((!COMM_IsDigit(value))||(parseInt(value) <= 0))
									return I18N("j", "Please enter a value");
							}
							
							if(elem_id=="macAddress_PPPoE" && value != "" && (value=="00:00:00:00:00:00" || !COMM_IsMAC(value)))
							{
								return I18N("j", "Text field contains illegal characters.");
							}
							break;
							
						case "4": /* pptp */
							var PPTPStatus = document.getElementById("addressMode_PPTP").value;
							var PriPPTPDNS = document.getElementById("primaryDNSAddress_PPTP").value;
							
							if(elem_id=="serverIPAddress_PPTP")
							{
								if(value == "" || value == null)
									return I18N("j","Please enter a server address.");
								//else
								//{
								//	if(!COMM_ValidV4Format(value) || !COMM_ValidV4Addr(value))
								//		return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)");
								//}
							}
							
							if(elem_id == "userName_PPTP" && (value == "" || value == null))
								return I18N("j","Please enter a username.");
							
							//if(elem_id == "password_PPTP" && (value == "" || value == null))
							//	return I18N("j","Please enter a password.");
							
							if(PPTPStatus=="2")
							{
								if(elem_id=="ipAddress_PPTP")
								{
									if(value == "" || value == null)
										return I18N("j","Please enter an IP address.");
									else
									{
										if(!COMM_ValidV4Format(value) || !COMM_ValidV4Addr(value))
											return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)");
									}
								}
								
								if(elem_id=="subnetMask_PPTP")
								{
									if(value == "" || value == null)
										return I18N("j","Please enter a subnet mask.");
									else
									{
										var mask = COMM_IPv4MASK2INT(value);
										if(mask <= 0 || mask > 32)
											return I18N("j","Please enter a valid netmask. (e.g. 255.255.255.0)");
										if(mask < 8)
											return I18N("j", "The router would not support the subnet mask which length is less than Class A.");
									}
								}
								
								if(elem_id=="gatewayIP_PPTP")
								{
									if(value == "" || value == null)
										return I18N("j","Please enter a gateway address.");
									else
									{
										if(!COMM_ValidV4Format(value) || !COMM_ValidV4Addr(value))
											return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)");
									}
								}
								
								if(elem_id=="primaryDNSAddress_PPTP")
								{
									if(value == "" || value == null)
										return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)");
									else
									{
										if(!COMM_ValidV4Addr(value))
											return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)");
									}
								}
							}
							else
							{
								if(elem_id=="primaryDNSAddress_PPTP" && value != "" && value != "0.0.0.0")
								{
									if(!COMM_ValidV4Addr(value))
										return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)");
								}
							}
							
							if(elem_id=="secondaryDNSAddress_PPTP" && value != "" && value != "0.0.0.0")
							{
								if(PriPPTPDNS == "" || PriPPTPDNS == null)
									return I18N("j","Please enter a primary dns server");
	
								if(!COMM_ValidV4Addr(value))
									return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)");
							
								if(value == PriPPTPDNS)
									return I18N("j","Secondary DNS server should not be the same as Primary DNS server.");
							}
							
							if(elem_id=="mtu_PPTP_Input" && $("#mtu_PPTP")[0].value=="2")
								if(!COMM_IsInteger(value) || value < 1280 || 1460 < value)
									return I18N("j", "The MTU value should be 1280 ~ 1460.");

							if(elem_id=="maximumIdleTime_PPTP")
							{
								if((!COMM_IsDigit(value))||(parseInt(value) <= 0))
									return I18N("j", "Please enter a value");
							}
							break;
						case "5": /* l2tp */
							var L2TPStatus = document.getElementById("addressMode_L2TP").value;
							var PriL2TPDNS = document.getElementById("primaryDNSAddress_L2TP").value;
							
							if(elem_id=="serverIPAddress_L2TP")
							{
								if(value == "" || value == null)
									return I18N("j","Please enter a server address.");
								//else
								//{
								//	if(!COMM_ValidV4Format(value) || !COMM_ValidV4Addr(value))
								//		return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)");
								//}
							}
							
							if(elem_id == "userName_L2TP" && (value == "" || value == null))
								return I18N("j","Please enter a username.");
							
							//if(elem_id == "password_L2TP" && (value == "" || value == null))
							//	return I18N("j","Please enter a password.");
							
							if(L2TPStatus=="2")
							{
								if(elem_id=="ipAddress_L2TP")
								{
									if(value == "" || value == null)
										return I18N("j","Please enter an IP address.");
									else
									{
										if(!COMM_ValidV4Format(value) || !COMM_ValidV4Addr(value))
											return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)");
									}
								}
								
								if(elem_id=="subnetMask_L2TP")
								{
									if(value == "" || value == null)
										return I18N("j","Please enter a subnet mask.");
									else
									{
										var mask = COMM_IPv4MASK2INT(value);
										if(mask <= 0 || mask > 32)
											return I18N("j","Please enter a valid netmask. (e.g. 255.255.255.0)");
										if(mask < 8)
											return I18N("j", "The router would not support the subnet mask which length is less than Class A.");
									}
								}
								
								if(elem_id=="gatewayIP_L2TP")
								{
									if(value == "" || value == null)
										return I18N("j","Please enter a gateway address.");
									else
									{
										if(!COMM_ValidV4Format(value) || !COMM_ValidV4Addr(value))
											return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)");
									}
								}
								
								if(elem_id=="primaryDNSAddress_L2TP")
								{
									if(value == "" || value == null)
										return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)");
									else
									{
										if(!COMM_ValidV4Addr(value))
											return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)");
									}
								}
							}
							else
							{
								if(elem_id=="primaryDNSAddress_L2TP" && value != "" && value != "0.0.0.0")
								{
									if(!COMM_ValidV4Addr(value))
										return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)");
								}
							}
							
							if(elem_id=="secondaryDNSAddress_L2TP" && value != "" && value != "0.0.0.0")
							{
								if(PriL2TPDNS == "" || PriL2TPDNS == null)
									return I18N("j","Please enter a primary dns server");
	
								if(!COMM_ValidV4Addr(value))
									return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)");
							
								if(value == PriL2TPDNS)
									return I18N("j","Secondary DNS server should not be the same as Primary DNS server.");
							}
							
							if(elem_id=="mtu_L2TP_Input" && $("#mtu_L2TP")[0].value=="2")
								if(!COMM_IsInteger(value) || value < 1280 || 1460 < value)
									return I18N("j", "The MTU value should be 1280 ~ 1460.");

							if(elem_id=="maximumIdleTime_L2TP")
							{
								if((!COMM_IsDigit(value))||(parseInt(value) <= 0))
									return I18N("j", "Please enter a value");
							}
							break;
						case "6": /* dslite */
							var validregex = /^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/;
							var DSLiteStatus = document.getElementById("configuration_DSLite").value;

							if(DSLiteStatus=="1" && elem_id=="afterIPv6Address_DSLite")
							{
								if(value=="" || value==null)
									return I18N("j","Please enter an IPv6 address.");
								else
									if(!validregex.test(value))
										return I18N("j","Please enter a valid IPv6 address. (e.g. 2001::1)");
							}
							
							if(elem_id=="b4IPv4Address_DSLite")
							{
								if(value != "")
								{
									if(value < 1 || value > 254)
											return I18N("j","Please enter a valid IP address. (e.g. 192.168.0.1)");
								}
							}
							break;
					}
				}
				
				return "";
			}, "");
			
			$('#internet_form').validate({
				submitHandler: function(form) {
					CheckConnectionStatus();
				}
			});
			
			var elements = $("#iPAddress_StaticIP, #subnetMask_StaticIP, #defaultGateway_StaticIP, #primaryDNSAddress_StaticIP, #secondaryDNSAddress_StaticIP, #primaryDNSAddress_DynamicIP, #secondaryDNSAddress_DynamicIP, #userName_PPPoE, #password_PPPoE, #ipAddress_PPPoE, #primaryDNSAddress_PPPoE, #secondaryDNSAddress_PPPoE, #serverIPAddress_PPTP, #userName_PPTP, #password_PPTP, #ipAddress_PPTP, #subnetMask_PPTP, #gatewayIP_PPTP, #primaryDNSAddress_PPTP, #secondaryDNSAddress_PPTP, #serverIPAddress_L2TP, #userName_L2TP, #password_L2TP, #ipAddress_L2TP, #subnetMask_L2TP, #gatewayIP_L2TP, #primaryDNSAddress_L2TP, #secondaryDNSAddress_L2TP, #afterIPv6Address_DSLite, #value_Session, #mtu_StaticIP_Input, #mtu_DynamicIP_Input, #mtu_PPPoE_Input, #mtu_PPTP_Input, #mtu_L2TP_Input, #b4IPv4Address_DSLite, #maximumIdleTime_PPPoE, #maximumIdleTime_PPTP, #maximumIdleTime_L2TP, #macAddress_DynamicIP, #macAddress_StaticIP");
			$.each(elements, function(i, element) {
				$(this).rules("add", { checkSetValues: true });
			});


			presetCheckBox("enableVLAN", true); //Support WAN_VLAN
			presetCheckBox("disableNAT", true); //Support disable_NAT
			//jquery
			$("div.checkbox_on" || "div.checkbox_off").click(function(e) {
			 var checkboxId =  e.target.id +'_ck';
				if(e.target.getAttribute("class") == "checkbox_on") {
					var disable = I18N("j","Disabled");
					e.target.setAttribute("class", "checkbox_off");
					e.target.setAttribute("className", "checkbox_off");
					document.getElementById(e.target.id).innerHTML='<input type="checkbox" name=' + e.target.id + ' id=' + checkboxId + ' checked>'+disable;
					document.getElementById(checkboxId).checked=false;

					/* Support WAN_VLAN - function for change checkbox - Start */
					if (checkboxId == "enableVLAN_ck")
					{
						document.getElementById("advancedBlock_VLANSetting").style.display = "none";
						document.getElementById("advancedBlock_hr").style.display = "none";
					}
					/* Support WAN_VLAN - function for change checkbox - End */
					changeFlag = true;
					save_button_changed();
				}
				else {
					var enable = I18N("j","Enabled");
					e.target.setAttribute("class", "checkbox_on");
					e.target.setAttribute("className", "checkbox_on");
					document.getElementById(e.target.id).innerHTML='<input type="checkbox" name=' + e.target.id + ' id=' + checkboxId + ' checked="">'+enable;
					document.getElementById(checkboxId).checked=true;

					/* Support WAN_VLAN - function for change checkbox - Start */
					if (checkboxId == "enableVLAN_ck")
					{
						document.getElementById("advancedBlock_VLANSetting").style.display = "inline";
						document.getElementById("advancedBlock_hr").style.display = "inline";
					}
					/* Support WAN_VLAN - function for change checkbox - End */
					changeFlag = true;
					save_button_changed();
				}
			});
		});
	</script>
</body>
<script type="text/javascript">
	Load_HTML();
	Initial();
	setMenu("menu_Settings");
	GetXML();
	startTimeout();
</script>
</html>

